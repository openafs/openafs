.rn '' }`
''' $RCSfile$$Revision$$Date$
'''
''' $Log$
'''
.de Sh
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp
.if t .sp .5v
.if n .sp
..
.de Ip
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.de Vb
.ft CW
.nf
.ne \\$1
..
.de Ve
.ft R

.fi
..
'''
'''
'''     Set up \*(-- to give an unbreakable dash;
'''     string Tr holds user defined translation string.
'''     Bell System Logo is used as a dummy character.
'''
.tr \(*W-|\(bv\*(Tr
.ie n \{\
.ds -- \(*W-
.ds PI pi
.if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\" diablo 12 pitch
.ds L" ""
.ds R" ""
'''   \*(M", \*(S", \*(N" and \*(T" are the equivalent of
'''   \*(L" and \*(R", except that they are used on ".xx" lines,
'''   such as .IP and .SH, which do another additional levels of
'''   double-quote interpretation
.ds M" """
.ds S" """
.ds N" """""
.ds T" """""
.ds L' '
.ds R' '
.ds M' '
.ds S' '
.ds N' '
.ds T' '
'br\}
.el\{\
.ds -- \(em\|
.tr \*(Tr
.ds L" ``
.ds R" ''
.ds M" ``
.ds S" ''
.ds N" ``
.ds T" ''
.ds L' `
.ds R' '
.ds M' `
.ds S' '
.ds N' `
.ds T' '
.ds PI \(*p
'br\}
.\"	If the F register is turned on, we'll generate
.\"	index entries out stderr for the following things:
.\"		TH	Title 
.\"		SH	Header
.\"		Sh	Subsection 
.\"		Ip	Item
.\"		X<>	Xref  (embedded
.\"	Of course, you have to process the output yourself
.\"	in some meaninful fashion.
.if \nF \{
.de IX
.tm Index:\\$1\t\\n%\t"\\$2"
..
.nr % 0
.rr F
.\}
.TH backup_dbverify 8 "OpenAFS" "1/Mar/2006" "AFS Command Reference"
.UC
.if n .hy 0
.if n .na
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.de CQ          \" put $1 in typewriter font
.ft CW
'if n "\c
'if t \\&\\$1\c
'if n \\&\\$1\c
'if n \&"
\\&\\$2 \\$3 \\$4 \\$5 \\$6 \\$7
'.ft R
..
.\" @(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2
.	\" AM - accent mark definitions
.bd B 3
.	\" fudge factors for nroff and troff
.if n \{\
.	ds #H 0
.	ds #V .8m
.	ds #F .3m
.	ds #[ \f1
.	ds #] \fP
.\}
.if t \{\
.	ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.	ds #V .6m
.	ds #F 0
.	ds #[ \&
.	ds #] \&
.\}
.	\" simple accents for nroff and troff
.if n \{\
.	ds ' \&
.	ds ` \&
.	ds ^ \&
.	ds , \&
.	ds ~ ~
.	ds ? ?
.	ds ! !
.	ds /
.	ds q
.\}
.if t \{\
.	ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.	ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.	ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.	ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.	ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.	ds ? \s-2c\h'-\w'c'u*7/10'\u\h'\*(#H'\zi\d\s+2\h'\w'c'u*8/10'
.	ds ! \s-2\(or\s+2\h'-\w'\(or'u'\v'-.8m'.\v'.8m'
.	ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.	ds q o\h'-\w'o'u*8/10'\s-4\v'.4m'\z\(*i\v'-.4m'\s+4\h'\w'o'u*8/10'
.\}
.	\" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds v \\k:\h'-(\\n(.wu*9/10-\*(#H)'\v'-\*(#V'\*(#[\s-4v\s0\v'\*(#V'\h'|\\n:u'\*(#]
.ds _ \\k:\h'-(\\n(.wu*9/10-\*(#H+(\*(#F*2/3))'\v'-.4m'\z\(hy\v'.4m'\h'|\\n:u'
.ds . \\k:\h'-(\\n(.wu*8/10)'\v'\*(#V*4/10'\z.\v'-\*(#V*4/10'\h'|\\n:u'
.ds 3 \*(#[\v'.2m'\s-2\&3\s0\v'-.2m'\*(#]
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.ds oe o\h'-(\w'o'u*4/10)'e
.ds Oe O\h'-(\w'O'u*4/10)'E
.	\" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.	\" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.	ds : e
.	ds 8 ss
.	ds v \h'-1'\o'\(aa\(ga'
.	ds _ \h'-1'^
.	ds . \h'-1'.
.	ds 3 3
.	ds o a
.	ds d- d\h'-1'\(ga
.	ds D- D\h'-1'\(hy
.	ds th \o'bp'
.	ds Th \o'LP'
.	ds ae ae
.	ds Ae AE
.	ds oe oe
.	ds Oe OE
.\}
.rm #[ #] #H #V #F C
.SH "NAME"
backup dbverify \- Checks the integrity of the Backup Database
.SH "SYNOPSIS"
\fBbackup dbverify\fR [\fB\-detail\fR] [\fB\-localauth\fR] <<\ [\fB\-cell\fR\ <\fIcell\ name\fR] >>>
    [\fB\-help\fR]
.PP
\fBbackup db\fR [\fB\-d\fR] [\fB\-l\fR] <<\ [\fB\-c\fR\ <\fIcell\ name\fR] >>> [\fB\-h\fR]
.SH "DESCRIPTION"
The \fBbackup dbverify\fR command checks the integrity of the Backup
Database. The command's output indicates whether the Backup Database is
damaged (data is corrupted) or not. If the Backup Database is undamaged,
it is safe to continue using it. If it is corrupted, discontinue any
backup operations until it is repaired.
.SH "CAUTIONS"
While this command runs, no other backup operation can access the Backup
Database; the other commands do not run until this command
completes. Avoid issuing this command when other backup operations are
likely to run. The \fBbackup savedb\fR command repairs some types of
corruption.
.SH "OPTIONS"
.Ip "\fB\-detail\fR" 4
Reports the number of orphaned blocks found, any inconsistencies, and the
name of the server machine running the Backup Server that is checking its
copy of the database.
.Ip "\fB\-localauth\fR" 4
Constructs a server ticket using a key from the local
\fI/usr/afs/etc/KeyFile\fR file. The \fBbackup\fR command interpreter presents
it to the Backup Server, Volume Server and \s-1VL\s0 Server during mutual
authentication. Do not combine this flag with the \fB\-cell\fR argument. For
more details, see the \fIbackup(8)\fR manpage.
.Ip "\fB\-cell\fR <\fIcell name\fR>" 4
Names the cell in which to run the command. Do not combine this argument
with the \fB\-localauth\fR flag. For more details, see the \fIbackup(8)\fR manpage.
.Ip "\fB\-help\fR" 4
Prints the online help for this command. All other valid options are
ignored.
.SH "OUTPUT"
The command displays one of the following two messages:
.Ip "Database \s-1OK\s0" 4
The database is undamaged and can be used.
.Ip "Database not \s-1OK\s0" 4
The database is damaged. You can use the backup savedb command to repair
many kinds of corruption as it creates a backup copy.  For more detailed
instructions, see the \fI\s-1IBM\s0 \s-1AFS\s0 Administration Guide\fR chapter about
performing backup operations.
.PP
The \fB\-detail\fR flag provides additional information:
.Ip "\(bu" 4
The number of \fIorphan blocks\fR found. These are ranges of memory that the
Backup Server preallocated in the database but cannot use. Orphan blocks
do not interfere with database access, but do waste disk space. To free
the unusable space, dump the database to tape by using the \fBbackup
savedb\fR command, and then restore it by using the \fBbackup restoredb\fR
command.
.Ip "\(bu" 4
Any inconsistencies in the database, such as invalid hostnames for Tape
Coordinator machines.
.Ip "\(bu" 4
The name of the database server machine on which the Backup Database was
checked, designated as the \f(CWDatabase checker\fR. For a detailed trace of
the verification operation, see the \fI/usr/afs/logs/BackupLog\fR file on the
indicated machine. You can use the \fBbos getlog\fR command to display it.
.SH "EXAMPLES"
The following command confirms that the Backup Database is undamaged:
.PP
.Vb 2
\&   % backup dbverify
\&   Database OK
.Ve
The following command confirms that the Backup Database is undamaged and
that it has no orphan blocks or invalid Tape Coordinator entries. The
Backup Server running on the machine \f(CWdb1.abc.com\fR checked its copy of
the Database.
.PP
.Vb 4
\&   % backup dbverify -detail
\&   Database OK
\&   Orphan blocks 0
\&   Database checker was db1.abc.com
.Ve
.SH "PRIVILEGE REQUIRED"
The issuer must be listed in the \fI/usr/afs/etc/UserList\fR file on every
machine where the Backup Server is running, or must be logged onto a
server machine as the local superuser \f(CWroot\fR if the \fB\-localauth\fR flag is
included.
.SH "SEE ALSO"
the \fIBackupLog(5)\fR manpage,
the \fIbackup(8)\fR manpage,
the \fIbackup_restoredb(8)\fR manpage,
the \fIbackup_savedb(8)\fR manpage,
the \fIbos_getlog(8)\fR manpage
.SH "COPYRIGHT"
IBM Corporation 2000. <http://www.ibm.com/> All Rights Reserved.
.PP
This documentation is covered by the IBM Public License Version 1.0.  It was
converted from HTML to POD by software written by Chas Williams and Russ
Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.

.rn }` ''
.IX Title "backup_dbverify 8"
.IX Name "backup dbverify - Checks the integrity of the Backup Database"

.IX Header "NAME"

.IX Header "SYNOPSIS"

.IX Header "DESCRIPTION"

.IX Header "CAUTIONS"

.IX Header "OPTIONS"

.IX Item "\fB\-detail\fR"

.IX Item "\fB\-localauth\fR"

.IX Item "\fB\-cell\fR <\fIcell name\fR>"

.IX Item "\fB\-help\fR"

.IX Header "OUTPUT"

.IX Item "Database \s-1OK\s0"

.IX Item "Database not \s-1OK\s0"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Header "EXAMPLES"

.IX Header "PRIVILEGE REQUIRED"

.IX Header "SEE ALSO"

.IX Header "COPYRIGHT"

