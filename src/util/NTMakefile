# Copyright 2000, International Business Machines Corporation and others.
# All Rights Reserved.
# 
# This software has been released under the terms of the IBM Public
# License.  For details, see the LICENSE file in the top-level source
# directory or online at http://www.openafs.org/dl/license10.html

# General AFS utilities.

!INCLUDE ..\config\NTMakefile.$(SYS_NAME)

INCFILEDIR = $(DESTDIR)\include\afs  # header file install directory

INCFILES =\
	$(INCFILEDIR)\afsutil.h \
	$(INCFILEDIR)\assert.h \
	$(INCFILEDIR)\dirent.h \
	$(INCFILEDIR)\errors.h \
	$(INCFILEDIR)\itc.h \
	$(INCFILEDIR)\vice.h \
	$(INCFILEDIR)\pthread_glock.h \
	$(INCFILEDIR)\pthread_nosigs.h \
	$(INCFILEDIR)\errmap_nt.h \
	$(INCFILEDIR)\dirpath.h \
	$(INCFILEDIR)\ktime.h \
	$(INCFILEDIR)\fileutil.h \
	$(INCFILEDIR)\afsutil_prototypes.h \
	$(INCFILEDIR)\secutil_nt.h

$(INCFILEDIR)\dirent.h: dirent_nt.h
	$(COPY) $** $@

$(INCFILEDIR)\afsconfig.h: ..\libadmin\adminutil\afscoinfig.h
	$(COPY) $** $@

$(INCFILEDIR)\dirpath.h: dirpath_nt.h
	$(COPY) $** $@

LIBFILE = $(DESTDIR)\lib\afs\afsutil.lib

LIBOBJS = \
	assert.obj \
	base32.obj \
	casestrcpy.obj \
	get_krbrlm.obj \
	hostparse.obj \
	isathing.obj \
	kreltime.obj \
	ktime.obj \
	regex.obj \
	readdir_nt.obj \
	serverLog.obj \
	uuid.obj \
	volparse.obj \
	winsock_nt.obj \
	errmap_nt.obj \
	dirpath.obj \
	fileutil.obj \
	secutil_nt.obj

$(LIBOBJS): $$(@B).c
	$(C2OBJ) -I..\libadmin\adminutil $**

$(LIBOBJS):

$(LIBFILE): $(LIBOBJS)
	$(LIBARCH)


install: $(INCFILES) $(LIBFILE)

install9x: install

clean::
	$(DEL) $(LIBFILE)