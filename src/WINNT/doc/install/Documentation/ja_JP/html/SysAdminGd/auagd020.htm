<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3//EN">
<HTML><HEAD>
<TITLE>管理の手引き</TITLE>
<!-- Begin Header Records  ========================================== -->
<!-- E:\IDWB\TEMP\idwt2118\AUAGD000.SCR converted by idb2h R4.2 (359) -->
<!-- ID Workbench Version (OS2) on 24 Dec 1999 at 12:07:32            -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Shift_JIS">
<META HTTP-EQUIV="updated" CONTENT="Fri, 24 Dec 1999 12:07:30">
<META HTTP-EQUIV="review" CONTENT="Sun, 24 Dec 2000 12:07:30">
<META HTTP-EQUIV="expires" CONTENT="Mon, 24 Dec 2001 12:07:30">
</HEAD><BODY>
<!-- (C) IBM Corporation 2000. All Rights Reserved    --> 
<BODY bgcolor="ffffff"> 
<!-- End Header Records  ============================================ -->
<A NAME="Top_Of_Page"></A>
<H1>管理の手引き</H1>
<HR><H1><A NAME="HDRWQ773" HREF="auagd002.htm#ToC_628">アクセス制御リスト (ACL) の管理</A></H1>
<P>ディレクトリーおよびその中にあるすべてのファイルへのアクセスを制御するために、
UNIX ファイル・システム (UFS) では、モード・ビットを個々のファイルやディレクトリーと関連付けますが、
AFS では、モード・ビットではなく、<I>アクセス制御リスト</I> (<I>ACL</I>) をファイルやディレクトリーと関連付けます。
AFS ACL には、7 つのアクセス権および約 20 のユーザーまたはグループ項目のための空きがあるため、
3 つのアクセス権および 3 つの項目 (<B>所有者</B>、<B>グループ</B>、および<B>その他</B>) だけしかない UFS に比べて、より調整されたアクセス制御を提供することができます。
<HR><H2><A NAME="HDRWQ774" HREF="auagd002.htm#ToC_629">手順の概要</A></H2>
<P>この章では、指示されたコマンドを使って以下のタスクを実行する手順について説明します。
<BR>
<TABLE WIDTH="100%">
<TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="57%">アクセス制御リストの検証
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="43%"><B>fs listacl</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="57%">ACL の通常アクセス権機能グループの編集
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="43%"><B>fs setacl</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="57%">ACL の禁止アクセス権機能グループの編集
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="43%"><B>fs setacl</B>、
<B>-negative</B> フラグを併用
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="57%">ACL の置換
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="43%"><B>fs setacl</B> 、
<B>-clear</B> フラグを併用
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="57%">ACL のコピー
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="43%"><B>fs copyacl</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="57%">古くなった AFS UID の削除
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="43%"><B>fs cleanacl</B>
</TD></TR></TABLE>
<HR><H2><A NAME="HDRWQ781" HREF="auagd002.htm#ToC_630">AFS でのデータの保護</A></H2>
<A NAME="IDX8011"></A>
<A NAME="IDX8012"></A>
<P>この機能グループでは、AFS および UFS ファイル保護システムの主な違い、ディレクトリー・レベル保護の含意、および 7 つのアクセス権について説明します。
<P><H3><A NAME="HDRWQ782" HREF="auagd002.htm#ToC_631">UFS と AFS のデータ保護の違い</A></H3>
<A NAME="IDX8013"></A>
<A NAME="IDX8014"></A>
<A NAME="IDX8015"></A>
<P>UFS モード・ビット・データ保護システムおよび AFS ACL システムは、次の 2 点で異なります。
<UL>
<LI>ファイル・レベル (UFS) 保護対ディレクトリー・レベル (AFS) 保護
<P>
<P>UFS は、9 つのモード・ビットのセットを各ファイルの要素に関連付け、3 つ
(<B>rwx</B>) を要素の所有者、所有しているグループ、および他のすべてのユーザーにそれぞれ関連付けます。ファイルのディレクトリーにあるモード・ビットの類似セットは、間接的にそのファイルだけに適用されます。
<P>
<P>代わりに、AFS ACL は、ディレクトリー内のすべてのファイルを同じように保護します。他のファイルより機密性が高い特定ファイルは、制限性の高い ACL を持つディレクトリーに保管してください。
<P>
<P>ディレクトリー・レベルでアクセスを定義すると、次のような重大な影響が生じます。
<A NAME="IDX8016"></A>
<P>
<UL>
<LI>ディレクトリーの ACL 上の権限がディレクトリー内のすべてのファイルに適用されます。ファイルを別のディレクトリーに移動するとき、そのファイルに適用されるアクセス権を、新しいディレクトリーの ACL 上のアクセスに効果的に変更します。ディレクトリーの ACL を変更すると、そのディレクトリー内のすべてのファイル上の保護も変更します。
</LI><LI>サブディレクトリーを作成すると、初期 ACL がその親ディレクトリーも ACL のコピーとして作成されます。その後、サブディレクトリーの ACL を個別に変更することができます。ただし、親ディレクトリーの ACL は、以下の方法で、サブディレクトリーへのアクセスの制御を続けます。親ディレクトリーの ACL は、ユーザーがサブディレクトリーにはアクセスできるように、
<B>l</B> (<B>ルックアップ</B>) アクセス権をユーザー (またはユーザーが属しているグループ) に許可しなければなりません。
<P>
<P>一般的に、上位ディレクトリー (ホーム・ディレクトリーなど) には、かなり自由なアクセス権限を割り当てる必要があります。特に、少なくとも <B>l</B> アクセス権を、上位レベルのディレクトリーの <B>system:anyuser</B> または <B>system:authuser</B> グループに許可すると効果的です。詳しくは、
<A HREF="#HDRWQ787">ACL 上でのグループの使用</A>を参照してください。
</LI></UL>
</LI><LI>モード・ビットの解釈方法
<P>
<P>モード・ビットは、UFS の唯一のファイル保護システムです。AFS では、UNIX モード・ビットをそのディレクトリー上の ACL のほかに、ファイルにも設定できます、しかし、モード・ビットの解釈のしかたは UNIX ファイル・システムとは異なります。<A HREF="#HDRWQ796">AFS が UNIX モード・ビットを解釈する方法</A> を参照してください。
</LI><LI>3 つのアクセス権 (UFS) 対 7 つのアクセス権 (AFS)
<P>
<P>UFS では、アクセス権はモード・ビットの形式で定義されます。すなわち、<B>r</B>
(<B>読み取り</B>)、<B>w</B> (<B>書き込み</B>)、および <B>x</B> (<B>実行</B>) です。
AFS では、7 つのアクセス権は以下のように定義され、より精度の高いアクセス制御が可能です。詳しくは、<A HREF="#HDRWQ783">AFS ACL アクセス権</A> を参照してください。
<P>
<DL>
<DD><P><B>a</B> (<B>管理</B>)
<DD><P><B>d</B> (<B>削除</B>)
<DD><P><B>i</B> (<B>挿入</B>)
<DD><P><B>k</B> (<B>ロック</B>)
<DD><P><B>l</B> (<B>ルックアップ</B>)
<DD><P><B>r</B> (<B>読み取り</B>)
<DD><P><B>w</B> (<B>書き込み</B>)
</DL>
</LI><LI>3 つの定義済みユーザーとグループ (UFS) 対多数 (AFS) の定義済みユーザーとグループ
<P>
<P>UFS は、1 つのユーザーと 2 つのグループに対するアクセスを、モード・ビットの組を、それぞれ、ファイルまたはディレクトリーを所有するユーザー、単一の定義済みグループ、およびシステム上にアカウントを持つすべてのユーザーに与えることによって制御します。
<P>
<P>それに対して、AFS では、ACL 上に多数の項目 (個々のユーザーまたはグループ) を配置し、項目ごとに別々のアクセス権限のセットを付与できます。配置可能な項目の数は、約 20 個です。この数は、ACL 自体に割り振られているメモリー内で書く項目が占有するスペースによって異なります。
<P>
<P>AFS は、<B>system:anyuser</B> および <B>system:authuser</B> の 2 つのシステム・グループ定義します。これらは、すべてのユーザーおよび認証済みユーザーをそれぞれ表します。詳細は、
<A HREF="#HDRWQ787">ACL 上でのグループの使用</A> を参照してください。さらに、ユーザーは、個々のユーザーまたはマシンの IP アドレスから構成される、独自のグループを保護データベースに定義することができます。
ACL に対して <B>a</B> アクセス権を持つユーザーは、自分または他のユーザーが定義したグループだけでなく、システム・グループの項目も作成できます。グループの定義についての詳細は、<A HREF="auagd019.htm#HDRWQ722">保護データベースの管理</A> を参照してください。
<P>
<P>ユーザーがファイルまたはディレクトリーへのアクセスを要求すると、ファイル・サーバーは、関連する ACL がユーザーおよびユーザーが属するグループに拡張する許可をすべてまとめます。したがって、グループ項目を ACL に配置すると、
ACL が個々の項目として収容できる数よりも多くのユーザーに対して、アクセスを制御することができます。
</LI></UL>
<P><H3><A NAME="HDRWQ783" HREF="auagd002.htm#ToC_632">AFS ACL アクセス権</A></H3>
<A NAME="IDX8017"></A>
<A NAME="IDX8018"></A>
<A NAME="IDX8019"></A>
<P>機能的には、7 つの標準 ACL アクセス権は、2 つのグループに分けることができます。
1 つはディレクトリー自体に適用され、もう 1 つはディレクトリーに含まれるファイルに適用されます。
<P><H4><A NAME="HDRWQ784">4 つのディレクトリー・アクセス権</A></H4>
<P>このグループの 4 つの権限はディレクトリーそのものに適用される場合に有効です。たとえば、<B>i</B> (<B>挿入</B>) アクセス権は、ファイルへのデータの追加を制御しませんが、新規ファイルまたはサブディレクトリーの作成を制御します。
<DL>
<P><DT><B>l (ルックアップ) アクセス権
</B><DD>このアクセス権は、ディレクトリーおよびそのファイルへのアクセスに関して、門番のような働きをします。ユーザーは、他のアクセスを実行するためには、必ずルックアップ・アクセス権を持っていなければならないからです。特に、ユーザーが、ディレクトリーのサブディレクトリー内にアクセスするには、サブディレクトリー上の ACLが拡張アクセス権を許可したとしても、このルックアップ・アクセス権が必要です。
<A NAME="IDX8020"></A>
<A NAME="IDX8021"></A>
<P>
<P>
<P>このアクセス権によって、ユーザーは以下のコマンドを発行できます。
<UL>
<LI><B>ls</B> コマンド。ディレクトリー内のファイル名およびサブディレクトリー名をリストします。
</LI><LI><B>ls -ld</B> コマンド。ディレクトリー要素自体の完全な状況情報を入手します。
</LI><LI><B>fs listacl</B> コマンド。ディレクトリーの ACL を調べます。
</LI></UL>
<P>
<P>
<P>このアクセス権では、ユーザーはディレクトリー内のファイルの内容を読み取ったり、ディレクトリー内のファイルに対して <B>ls -l</B> コマンドを発行したり、ファイル名を <B>-path</B> 引き数にして
<B>fs listacl</B> コマンドを発行することはできません。これらのオペレーションには、<A HREF="#HDRWQ785">3 つのファイル・サーバー・アクセス権</A> で説明する <B>r</B> (<B>読み取り</B>) アクセス権が必要です。
<P>
<P>同様に、このアクセス権は、ユーザーが、ディレクトリーのサブディレクトリーに対して<B>ls</B>、<B>ls -l</B>、<B>ls -ld</B>、または <B>fs listacl</B> コマンドを発行することを許可しません。これらのオペレーションには、サブディレクトリーそのものの ACL 上での <B>l</B> アクセス権が必要です。
<P><DT><B>i (挿入) アクセス権
</B><DD>このアクセス権は、ユーザーが、作成またはコピーすることによって、ディレクトリーに新規ファイルを追加することや、新規サブディレクトリーを作成することを許可します。この権限は、独自の ACL によって保護されているサブディレクトリーには拡張されません。
<A NAME="IDX8022"></A>
<A NAME="IDX8023"></A>
<P><DT><B>d (削除) アクセス権
</B><DD>このアクセス権は、ユーザーがファイルやサブディレクトリーをディレクトリーから削除することや、それらを別のディレクトリー (ユーザーが<B>挿入</B>権を持っているディレクトリー) に移動することを許可します。
<A NAME="IDX8024"></A>
<A NAME="IDX8025"></A>
<P><DT><B>a (管理) アクセス権
</B><DD>このアクセス権によって、ユーザーはディレクトリーの ACL 変更できます。
<B>system:administrators</B> グループのメンバーは、すべてのディレクトリーに対する
(すなわち、グループが ACL 上に表示されない場合でも) このアクセス権を暗黙的に持っています。同様に、ディレクトリーの所有者には、そのディレクトリーとその下にあるすべての所有しているディレクトリーの ACL で、この許可が暗黙的に設定されています。
<A NAME="IDX8026"></A>
<A NAME="IDX8027"></A>
</DL>
<P><H4><A NAME="HDRWQ785">3 つのファイル・サーバー・アクセス権</A></H4>
<P>このグループの 4 つの権限はディレクトリーそのものに適用される場合に有効です。
<DL>
<P><DT><B>r (読み取り) アクセス権
</B><DD>このアクセス権は、ユーザーがディレクトリーにあるファイルの内容を読み取ることや、<B>ls -l</B> コマンドを発行してそのファイルの要素を指定することを許可します。
<A NAME="IDX8028"></A>
<A NAME="IDX8029"></A>
<P><DT><B>w (書き込み) アクセス権
</B><DD>このアクセス権は、ユーザーがディレクトリー内のファイルの内容を変更することや、UNIX モード・ビットを <B>chmod</B> を使用して変更することを許可します。
<A NAME="IDX8030"></A>
<A NAME="IDX8031"></A>
<P><DT><B>k (ロック) アクセス権
</B><DD>このアクセス権は、ユーザーがシステム・コールを発行するするプログラムを実行してディレクトリー内ファイルをロックすることを許可します。
<A NAME="IDX8032"></A>
<A NAME="IDX8033"></A>
</DL>
<P><H4><A NAME="Header_635">8 つの補助アクセス権</A></H4>
<A NAME="IDX8034"></A>
<A NAME="IDX8035"></A>
<A NAME="IDX8036"></A>
<P>AFS では、意味が定義されていない、上段シフト文字
<B>A</B>、<B>B</B>、<B>C</B>、
<B>D</B>、<B>E</B>、<B>F</B>、
<B>G</B>、<B>H</B>の 8 つの追加アクセス権を使用できます。
<P>1 つまたは複数のアクセス権への割り当てを意味するアプリケーション・プログラムを作成して、それを ACL 上に配置し、これらのプログラムによってファイル・アクセスを制御することができます。たとえば、印刷プログラムを変更してアクセス権を認識および解釈し、そのプログラムがアクセスするファイルを収容するディレクトリーにそのプログラムを配置できます。<B>fs listacl</B>
<B>fs setacl</B> コマンドを使用して、標準の 7 つのアクセス権のように ACL に補助アクセス権を設定し、表示します。
<P><H4><A NAME="Header_636">アクセス権の組に対する省略表現</A></H4>
<A NAME="IDX8037"></A>
<A NAME="IDX8038"></A>
<P>7 つのアクセス権は、ACL 項目内で任意の方法で組み合わせることができます。しかし、組み合わせ方によってかなり便利になります。特に共通の 4 つの組み合わせには、対応する省略形があります。
<B>fs setacl</B>コマンドを使用して ACL 項目を定義する場合、権限を表す 1 つまたは複数の個々の文字を指定するか、または下記の省略形形式の 1 つを指定することができます。
<DL>
<A NAME="IDX8039"></A>
<P><DT><B>all
</B><DD>7 つの標準アクセス権すべてを表します (<B>rlidwka</B>)。
<A NAME="IDX8040"></A>
<P><DT><B>none
</B><DD>ACL から項目を削除します。ユーザーやグループにはアクセス権を何も残しません。
<A NAME="IDX8041"></A>
<P><DT><B>read
</B><DD><B>r</B> (<B>読み取り</B>) および <B>l</B> (<B>ルックアップ</B>) アクセス権を表します。
<A NAME="IDX8042"></A>
<P><DT><B>write
</B><DD><B>a</B> (<B>管理</B>): <B>rlidwk</B> を除くすべてのアクセス権を表します。
</DL>
<P><H3><A NAME="HDRWQ786" HREF="auagd002.htm#ToC_637">通常および禁止アクセス権の使用方法</A></H3>
<A NAME="IDX8043"></A>
<A NAME="IDX8044"></A>
<A NAME="IDX8045"></A>
<P>ACL は、ディレクトリーおよびその中のファイルへのアクセスを許可および禁止することができます。アクセスを許可するには、<A HREF="#HDRWQ789">ACL 項目の設定</A> で説明するように、<B>fs setacl</B> コマンドを使用して、アクセス権のセットをユーザーまたはグループに関連付ける ACL 項目を作成します。<B>fs listacl</B> コマンドを使用して ACL を表示すると (<A HREF="#HDRWQ788">ACL の表示</A>で説明するように) 、以下のヘッダーの下に項目が表示されます。<I>rights</I> という用語はアクセス権を表します。
<PRE>   Normal rights
</PRE>
<P>アクセスを禁止する方法は 2 つあります。
<OL TYPE=1>
<LI>単にユーザーまたはグループに対する項目を ACL から削除するか、項目から適切なアクセス権を削除する方法をお勧めします。<A HREF="#HDRWQ790">ACL 通常アクセス権を追加、削除、または編集するには</A> の説明に従って、<B>fs setacl</B> コマンドを使用して、既存の項目を削除または編集します。ほとんどの場合、特定の種類または特定のユーザーのアクセスを防ぐには、この方法で十分です。ただし、不必要なアクセス権を、そのようなユーザーが属する任意のグループに許可しないように注意が必要です。
</LI><LI>アクセス権をもっと明示的に禁止する方法では、<B>-negative</B> フラグを <B>fs setacl</B> コマンドで使用して、ユーザーまたはグループに <I>禁止アクセス権</I> を関連付ける項目を作成します。説明については、<A HREF="#HDRWQ791">ACL 禁止アクセス権を追加、削除、または編集するには</A> を参照してください。
<B>fs listacl</B> コマンドを使用して作成した出力には、以下のヘッダーの下に禁止項目がリストされます。
<P>
<PRE>   Negative rights
</PRE>
<P>
<P>どのタイプのアクセスをユーザーに許可するか決定すると、ファイル・サーバーは、まず ACL の <TT>Normal rights</TT> 機能グループのすべての項目を調べて、アクセス権のセットをコンパイルします。それから、ACL の <TT>Negative rights</TT> 機能グループ上にそのユーザー (またはユーザーが属しているグループ)に関連するすべてのアクセス権を抽出します。したがって、禁止アクセス権は、常に通常アクセス権を取り消します。
<P>
<P>禁止アクセス権を使用すると、<B>fs setacl</B> コマンドの通常の意味が逆転し、これは潜在的に混乱を生じる可能性があります。特に、<B>none</B> 省略表記と
<B>-negative</B> フラグを一緒に使用すると、二重否定になります。
ACL の <TT>Negative rights</TT> 機能グループから項目を削除することにより、
<TT>Normal rights</TT> 機能グループの項目を介して、ユーザーがもう一度アクセス権を取得できるようになります。<B>all</B> 省略表記と
<B>-negative</B> フラグと一緒に使用すると、すべてのアクセス権を明示的に禁止します。
<P>
<P><TT>Normal rights</TT> 機能グループの項目が、禁止されているアクセス権を <B>system:anyuser</B> グループに対して許可した場合、<TT>Negative
rights</TT> 機能グループに項目を作成するのは、無意味であることに注意してください。この場合、ユーザーは、単に <B>unlog</B> コマンドを使用してユーザーの持つトークンを廃棄することにより、アクセスを取得することができます。ユーザーがこれを行うと、ファイル・サーバーは、ユーザーを <B>anonymous</B> ユーザーとして認識します。anonymous ユーザーは、
<B>system:anyuser</B> グループに属していますが、ACL の
<TT>Negative rights</TT> 機能グループの項目と一致しません。
</LI></OL>
<P><H3><A NAME="HDRWQ787" HREF="auagd002.htm#ToC_638">ACL 上でのグループの使用</A></H3>
<A NAME="IDX8046"></A>
<A NAME="IDX8047"></A>
<P>前述したように、グループ項目を ACL に配置すると、一度に多数のユーザーにアクセスするのを制御することができます。新規ユーザーを、関連する ACL 上に表示されるグループに追加するだけで、そのユーザーに多数のファイルおよびディレクトリーへのアクセスを許可することができます。また、マシンのグループを作成することもできます。その場合は、マシンにログオンする任意のユーザーは、そのグループに許可されたアクセスを取得するようにできます。
ACL の <B>a</B> アクセス権を持つディレクトリー上では、ユーザーは独自のグループを定義したり、ユーザー自身が作成したグループや所有するグループだけでなく、任意のグループに対する ACL 項目を作成することができます。ユーザーまたはマシンのグループの作成についての説明、および異なるタイプのグループを使用する最も効果的な方法についての説明は、<A HREF="auagd019.htm#HDRWQ722">保護データベースの管理</A> を参照してください。
<A NAME="IDX8048"></A>
<A NAME="IDX8049"></A>
<A NAME="IDX8050"></A>
<A NAME="IDX8051"></A>
<A NAME="IDX8052"></A>
<P>AFS は、以下の 2 つのシステム・グループも定義します。このグループは、大きなユーザー・グループを潜在的に表すため、ACL 上で非常に便利です。これらのグループについての詳細は、
<A HREF="auagd019.htm#HDRWQ746">システム・グループ</A> を参照してください。
<DL>
<P><DT><B>system:anyuser
</B><DD>セルのファイル・ツリーにアクセスできるユーザー、ローカル・スーパーユーザー <B>root</B> としてログインし、セル以外の場所からローカル・マシンに接続したユーザー、および外部セルに属する AFS ユーザーが組み込まれます。このグループには、ローカル AFS サーバーに対して有効なトークンを持たないユーザーが組み込まれています。サーバーは、このグループを <B>anonymous</B> として認識します。
<P>
<P>このグループに対してローカル認証アカウントを作成しない限り、このグループに ACL項目を作成することが、外部セルから AFS ユーザーへのアクセスを可能にする唯一の方法であることに注意してください。
<A NAME="IDX8053"></A>
<P><DT><B>system:authuser
</B><DD>ローカル・セルの認証サービスから取得した有効な AFS トークンを持つすべてのユーザーが組み込まれます。
</DL>
<P>特に、<B>l</B> (<B>ルックアップ</B>) 権をファイル・システム内にある大部分のディレクトリーの ACL 上の <B>system:anyuser</B> に付与するのに有用です。このアクセス権によって、ディレクトリー内のファイルとサブディレクトリーの名前がないとターゲット・ファイルへのパス内のディレクトリーと交信できないユーザーが、その名前を知ることができます。
<P>少し制限的になりますが、代わりに <B>l</B>権を <B>system:authuser</B> グループに付与する方法があります。それでも制限がある場合、
<B>l</B> アクセス権を特定のユーザーまたはグループに付与できますが、1 つの指定された ACL 上の数が 約 20 を超えることはできません。
<P><B>system:anyuser</B> グループに特定のアクセス権を許可するもう 1つの理由は、印刷やメール送達などのサービスを提供するプロセスの正しいオペレーションが可能になることです。たとえば、<B>l</B> 権に加えて、印刷プロセスは、ファイルの内容を印刷するには <B>r</B> (<B>読み取り</B>) 権が必要です。また、メール送達プロセスは、新規メールを送達するために <B>i</B> (<B>挿入</B>) 権が必要です。
<P>すべての新規に作成されたボリュームのルート・ディレクトリー上の ACL は、
<B>system:administrators</B> グループにすべてのアクセス権を許可します。この記入項目を削除したい場合は削除できますが、
<B>system:administrators</B> グループのメンバーは、すべてのディレクトリーの ACL で、暗黙的に常に <B>a</B> (<B>管理</B>) アクセス権を所有し、また、デフォルトで <B>l</B> アクセス権も所有しています。
<B>a</B> アクセス権を使用すると、他の必要なアクセス権を、自分自身に明示的に付与することができます。この権限のデフォルト設定の変更については、
<A HREF="auagd021.htm#HDRWQ809">system:administrators グループの管理</A> を参照してください。
<HR><H2><A NAME="HDRWQ788" HREF="auagd002.htm#ToC_639">ACL の表示</A></H2>
<A NAME="IDX8054"></A>
<A NAME="IDX8055"></A>
<P>ファイル、ディレクトリー、またはシンボリック・リンクに関連する ACL を表示するには、
<B>fs listacl</B> コマンドを発行します。シンボリック・リンクの出力は、そのシンボリック・リンクがあるディレクトリーの ACL ではなく、ターゲット・ファイルまたはディレクトリーに適用される ACL を表示します。
<P><B>AFS/DFS 移行ツールキット・ユーザーへの注意:</B>ユーザーが <B>fs listacl</B> コマンドを発行するマシンが、AFS/DFS 移行ツールキット経由で DCE セルの DFS ファイル・スペースにアクセスできるように構成されている場合は、このコマンドを使用して、DFS ファイルおよびディレクトリー上の ACL を表示できます。通常の ACL ではなく、DFS ディレクトリーの初期コンテナーおよび初期オブジェクト ACL を表示する場合、
<B>fs listacl</B> コマンドの <B>-id</B> または <B>-if</B> フラグを組み込みます。説明については、<I>AFS/DFS Migration Toolkit Administration Guide and Reference</I> を参照してください。<B> fs</B> コマンド・インタープリターでは、AFS ACL を表示するときに組み込まれていても、<B>-id</B> および <B>-if</B> フラグは無視されます。
<A NAME="IDX8056"></A>
<A NAME="IDX8057"></A>
<P><H3><A NAME="Header_640" HREF="auagd002.htm#ToC_640">ACL を表示するには</A></H3>
<OL TYPE=1>
<LI><B>fs listacl</B> コマンドを発行します。
<P>
<PRE>   % <B>fs listacl</B> [&lt;<VAR>dir/file path</VAR>><SUP>+</SUP>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>la
</B><DD>は、<B>listacl</B> の受け入れ可能な別名です
(<B>lista</B> は受け入れ可能な最も短い省略形です)。
<P><DT><B><VAR>dir/file path</VAR>
</B><DD>ACL に表示する 1 つまたは複数のファイルやディレクトリーを指定します。ファイルの場合、そのファイルのディレクトリーの ACL が出力されます。この引き数を省略すると、現行作業ディレクトリーが出力されます。パス名の一部は、現行作業ディレクトリーとの関連で解釈されます。パス名自体またはパス名の一部として、以下の表記を使用することもできます。
<P>
<DL>
<P><DT><B>.
</B><DD>(1 つのピリオド)。現行作業ディレクトリーを指定します。
<P><DT><B>..
</B><DD>(2 つのピリオド)。現行作業ディレクトリーの親ディレクトリーを指定します。
<P><DT><B>*
</B><DD>(アスタリスク)。現行作業ディレクトリー内の各ファイルおよびサブディレクトリーを指定します。ファイルに対して表示される ACL は、常にそのディレクトリーに表示される ACL と同一ですが、各サブディレクトリーの ACL は異なることがあります。
</DL>
</DL>
</LI></OL>
<P>以下のエラー・メッセージは、ユーザーには、ACL を表示するために必要なアクセス権がないことを示しています。ディレクトリー名を <VAR>dir/file path</VAR> 引き数として指定するには、その ACL 上に <B>l</B> (<B>ルックアップ</B>) アクセス権がなくてはなりません。ファイル名を指定するには、ディレクトリーの ACL 上に <B>r</B> (<B>読み取り</B>) アクセス権がなくてはなりません。
<PRE>   fs: You don't have the required access permissions on '<VAR>dir/file path</VAR>'
</PRE>
<P><B>system:administrators</B> グループのメンバー、およびそのディレクトリーの所有者 (<B>ls -ld</B> コマンドによってレポートされている) は、すべてのディレクトリーの ACL 上に <B>a</B> (<B>管理</B>) アクセス権を暗黙的に持ち、
<B> fs setacl</B> コマンドを使用して、自分に必要なアクセス権を付与することができます。説明については、<A HREF="#HDRWQ789">ACL 項目の設定</A> を参照してください。
<P><VAR>dir/file path</VAR> として指定される各ファイルまたはディレクトリーの出力は、識別するため、以下のヘッダーで始まります。
<PRE>   Access list for  <VAR>dir/file path</VAR> is
</PRE>
<P><TT>Normal rights</TT> ヘッダーが次の行に表示されます。その後、各行にユーザーまたはグループ名、アクセス権のセットの対が表示されます。権限は、<A HREF="#HDRWQ783">AFS ACL アクセス権</A>で定義された単一文字として、かならず <B>rlidwka</B>の順序で表示されます。禁止アクセス権が含まれる場合は、
<TT>Negative rights</TT> ヘッダーが次に表示され、その後、禁止アクセス権の対が表示されます。
<P>以下の例は、ABC Corporation セルにおける、ユーザー <B>terry</B>のホーム・ディレクトリーの ACL が表示されます。
<PRE>   % <B>fs la /afs/abc.com/usr/terry</B>
   Access list for /afs/abc.com/usr/terry is
   Normal permissions:
      system:authuser rl
      pat rlw
     terry rlidwka
   Negative permissions:
      terry:other-dept rl
      jones rl
</PRE>
<P>ここでの <B>pat</B>、<B>terry</B>、および <B>jones</B> は、個々のユーザーです。<B>system:authuser</B> は、システム定義グループです。そして <B>terry:other-dept</B> は、<B>terry</B> が所有するグループです。通常アクセス権のリストでは、すべてのアクセス権を <B>terry</B> に許可し、
<B>pat</B> には、<B>r</B> (<B>読み取り</B>)、<B>l</B> (<B>ルックアップ</B>)、
<B>w</B> (<B>書き込み</B>) アクセス権を、そして <B>system:authuser</B> グループのメンバーには、
<B>r</B> および <B>l</B> アクセス権を許可します。
<P>禁止アクセス権リストでは、<B>jones</B> および<B>terry:other-dept</B> グループのメンバーに対し、
<B>r</B> および <B>l</B> アクセス権を禁止しています。これらの項目は、どのような方法にせよ <B>terry</B> のホーム・ディレクトリーへのアクセスを効果的に防止します。なぜなら、ユーザーは、自分たちに適用される可能性のある ACL の <TT>Normal rights</TT> 機能グループの唯一の項目である
<B>system:authuser</B> グループに拡張されている <B>r</B> および <B>l</B> アクセス権を取り消されているからです。
<HR><H2><A NAME="HDRWQ789" HREF="auagd002.htm#ToC_641">ACL 項目の設定</A></H2>
<A NAME="IDX8058"></A>
<A NAME="IDX8059"></A>
<A NAME="IDX8060"></A>
<A NAME="IDX8061"></A>
<A NAME="IDX8062"></A>
<A NAME="IDX8063"></A>
<A NAME="IDX8064"></A>
<A NAME="IDX8065"></A>
<A NAME="IDX8066"></A>
<A NAME="IDX8067"></A>
<P>ACL 項目を追加、削除、または編集するには、<B>fs setacl</B> コマンドを使用します。デフォルトでは、このコマンドは、ACL の通常アクセス権機能グループの項目を操作します。禁止アクセス権機能グループの項目を操作するには、<B>-negative</B> フラグを組み込みます。
<P>ACL を編集するには、ACL 上に <B>a</B> (<B>管理</B>) アクセス権がなくてはなりません。ディレクトリーの所有者、および<B>system:administrators</B> グループのメンバー (<B> ls -ld</B> コマンドによってレポートされる) は、暗黙的にこのアクセス権をすべての ACL 上に持っています。<B> system:administrators</B> グループのデフォルトのメンバーは、暗黙的に <B>l</B> (<B>ルックアップ</B>) アクセス権を持っています。
<P><B>AFS/DFS 移行ツールキット・ユーザーへの注意:</B>ユーザーが <B> fs setacl</B> コマンドを発行するマシンが、AFS/DFS 移行ツールキット経由で DCE セルの DFS ファイル・スペースにアクセスできるように構成されている場合は、このコマンドを使用して、DFS ファイルおよびディレクトリー上の ACL を設定できます。通常の ACL ではなく、DFS ディレクトリーの初期コンテナーおよび初期オブジェクト ACL を設定する場合、
<B>fs setacl</B> コマンドの <B>-id</B> または <B>-if</B> フラグを組み込みます。説明については、<I>AFS/DFS Migration Toolkit Administration Guide and Reference</I> を参照してください。<B> fs</B> コマンド・インタープリターでは、AFS ACL の設定時に組み込まれていても、<B>-id</B> および <B>-if</B> フラグは無視されます。
<A NAME="IDX8068"></A>
<A NAME="IDX8069"></A>
<P><H3><A NAME="HDRWQ790" HREF="auagd002.htm#ToC_642">ACL 通常アクセス権を追加、削除、または編集するには</A></H3>
<OL TYPE=1>
<LI>ACL を編集する各ディレクトリーに <B>a</B> (<B>管理</B>) 権があることを確認します。必要に応じて、<B>fs listacl</B> コマンドを発行します。これについては、
<A HREF="#HDRWQ788">ACL の表示</A> で詳しく説明しています。
<P>
<PRE>   % <B>fs listacl</B> [&lt;<VAR>dir/file path</VAR>>]
</PRE>
</LI><LI>必要に応じて、<B>fs setacl</B> コマンドを発行して、ACL の通常アクセス権機能グループの項目を編集します。項目を削除するには、アクセス権として、
<B>none</B> 省略表記を指定します。ACL 項目がすでにある場合は、指定した許可が、既存の項目の許可と完全に置き換えられます。
<P>
<PRE>   % <B>fs setacl -dir</B> &lt;<VAR>directory</VAR>><SUP>+</SUP> <B>-acl</B> &lt;<VAR>access list entries</VAR>><SUP>+</SUP>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>sa
</B><DD>は、<B>setacl</B> の受け入れ可能な別名です
(<B>seta</B> は受け入れ可能な最も短い省略形です)。
<P><DT><B>-dir
</B><DD><B>-acl</B> 引き数によって定義された ACL 項目に適用する、1つまたは服すのディレクトリーを指定します。パス名の一部は、現行作業ディレクトリーとの関連で解釈されます。
<P>
<P>各ディレクトリーに読み取り / 書き込みパスを指定して、読み取り専用ボリュームを変更しようとするときに障害が発生するのを防ぎます。規則では、パス名の第 2 レベルのセル名の前にピリオドを付けて、読み取り / 書き込みパスを指定します (たとえば、
<B>/afs/.abc.com</B>)。ファイル・スペースの読み取り / 書き込みパス、および読み取り専用パスの概念についての詳細は、
<A HREF="auagd010.htm#HDRWQ295">マウント・ポイント横断の規則</A> を参照してください。
<P>
<P>パス名自体またはパス名の一部として、以下の表記を使用することもできます。
<P>
<DL>
<P><DT><B>.
</B><DD>(1 つのピリオド)。単独で使用すると、現行作業ディレクトリーを設定します。
<P><DT><B>..
</B><DD>(2 つのピリオド)。単独で使用すると、現行作業ディレクトリーの親ディレクトリーを設定します。
<P><DT><B>*
</B><DD>(アスタリスク)。現行作業ディレクトリー内の各サブディレクトリーに ACL を設定します。アスタリスクの前に、複数のディレクトリーの可能性を示すため、<B>-dir</B> スイッチを付ける必要があります。<B>fs</B> コマンド・インタープリターにより、ディレクトリーの各ファイルごとに以下のエラー・メッセージが生成されます。
<P>
<PRE>   fs: '<VAR>filename</VAR>': Not a directory
</PRE>
</DL>
<P>
<P>
<P>1 つのディレクトリーまたはファイルのみを指定する場合は、
<B>-dir</B> スイッチと <B>-acl</B> スイッチを省略しても構いません。
<P><DT><B>-acl
</B><DD>1 つまたは複数の ACL 項目を指定します。各項目は、ユーザーまたはグループ名、アクセス権のセットが対になっています。1 つまたは複数のスペースを入れて、対を分離し、各対を 2 つの部分にします。
<P>
<P>アクセス権を定義するには、次のいずれかを指定します。
<UL>
<LI>任意の順序の、標準または補助アクセス権を表す 1 つまたは複数の文字 (<B>rlidwka</B> および <B>ABCDEFGH</B>)。
</LI><LI>4 つの省略表記の 1 つ。
<UL>
<LI><B>all</B> (すなわち、<B>rlidwka</B>)
</LI><LI><B>none</B> (項目を削除)
</LI><LI><B>read</B> (すなわち、<B>rl</B>)
</LI><LI><B>write</B> (すなわち、<B>rlidwk</B>)
</LI></UL>
</LI></UL>
<P>
<P>アクセス権および省略表現の詳細については、
<A HREF="#HDRWQ783">AFS ACL アクセス権</A> を参照してください。
<P>
<P>1 つのコマンド行に、ユーザーやグループの項目をいくつもつなげることができます。また、一部の対には個々の文字を使用し、それ以外の対には省略表現を使用することもできますが、
1 つの対の中で文字と省略表現を組み合わせて使用することはできません。
</DL>
</LI></OL>
<P>以下の例のいずれも、ユーザー <B>pat</B> に、発行者のホーム・ディレクトリーの<B>notes</B> サブディレクトリーの ACL 上での
<B>r</B> (<B>読み取り</B>) および <B>l</B> (<B>ルックアップ</B>) アクセス権を許可します。この例は、
1 つのディレクトリーだけを指定した場合に、<B>-dir</B> および <B>-acl</B>スイッチを省略する方法を示しています。
<PRE>   % <B>fs sa ~/notes pat rl</B>
   
   % <B>fs sa ~/notes pat read</B>
</PRE>
<P>以下の例では、現行作業ディレクトリーに対する ACL を編集しています。この例では、<B>system:anyuser</B> グループの項目を削除し、2 つの項目を追加しています。すべてのアクセス権を新規ユーザーに許可し、1 つの項目は、<B>a</B> (<B>管理</B>) 以外のすべてのアクセス権を <B>terry:colleagues</B> グループのメンバーに付与し、もう 1 つの項目では、<B>r</B> (<B>読み取り</B>) および <B>l</B> (<B>ルックアップ</B>) アクセス権を <B>system:authuser</B> グループに付与します。コマンドがここで 2 行に表示されているのは、ただ見やすくするためです。
<PRE>   % <B>fs  sa  -dir . -acl  system:anyuser  none  terry:colleagues  write  \
           system:authuser  rl</B>
</PRE>
<A NAME="IDX8070"></A>
<A NAME="IDX8071"></A>
<A NAME="IDX8072"></A>
<A NAME="IDX8073"></A>
<A NAME="IDX8074"></A>
<P><H3><A NAME="HDRWQ791" HREF="auagd002.htm#ToC_643">ACL 禁止アクセス権を追加、削除、または編集するには</A></H3>
<OL TYPE=1>
<LI>ACL を編集する各ディレクトリーに <B>a</B> (<B>管理</B>) 権があることを確認します。必要に応じて、<B>fs listacl</B> コマンドを発行します。これについては、<A HREF="#HDRWQ788">ACL の表示</A> で詳しく説明しています。
<P>
<PRE>   % <B>fs listacl</B> [&lt;<VAR>dir/file path</VAR>>]
</PRE>
</LI><LI><B>-negative</B> フラグを組み込んで <B>fs setacl</B> コマンドを発行して、ACL の禁止アクセス権機能グループの項目を編集します。項目を削除するには、アクセス権として、
<B>none</B> 省略表記を指定します。ACL 項目がユーザーまたはグループに既にある場合は、アクション権を指定すると、既存の項目と完全に置換されます。
<P>
<PRE>   % <B>fs setacl -dir</B> &lt;<VAR>directory</VAR>><SUP>+</SUP> <B>-acl</B> &lt;<VAR>access list entries</VAR>><SUP>+</SUP>  <B>-negative</B> 
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>sa
</B><DD>は、<B>setacl</B> の受け入れ可能な別名です
(<B>seta</B> は受け入れ可能な最も短い省略形です)。
<P><DT><B>-dir
</B><DD><B>-acl</B> 引き数によって定義された ACL 禁止項目に適用する、1 つまたは複数のディレクトリーを指定します。各ディレクトリーに読み取り / 書き込みパスを指定して、読み取り専用ボリュームを変更しようとするときに障害が発生するのを防ぎます。受け入れ可能な値の詳細については、
<A HREF="#HDRWQ790">ACL 通常アクセス権を追加、削除、または編集するには</A> を参照してください。
<P><DT><B>-acl
</B><DD>1 つまたは複数の ACL 項目を指定します。各項目は、ユーザーまたはグループ名、アクセス権のセットが対になっています。1 つまたは複数のスペースを入れて、対を分離し、各対を 2 つの部分にします。受け入れ可能な値の詳細については、
<A HREF="#HDRWQ790">ACL 通常アクセス権を追加、削除、または編集するには</A> を参照してください。各アクセス権の通常の意味が保持されるように留意してください。
<P><DT><B>-negative
</B><DD><B>-acl</B> 引き数によって定義した項目を、ACL の禁止アクセス権機能グループに <B>-dir</B> 引き数によって指定した各ディレクトリーに配置します。
</DL>
</LI></OL>
<P>以下の例では、ユーザー <B>pat</B> に、現行作業ディレクトリーの <B>project</B> サブディレクトリーに対する、<B>w</B> (<B>書き込み</B>) および <B>d</B> (<B>削除</B>) アクセス権を禁止しています。
<PRE>   % <B>fs sa project pat wd -neg</B>
</PRE>
<HR><H2><A NAME="HDRWQ792" HREF="auagd002.htm#ToC_644">ACL を完全に置換する</A></H2>
<A NAME="IDX8075"></A>
<A NAME="IDX8076"></A>
<A NAME="IDX8077"></A>
<A NAME="IDX8078"></A>
<A NAME="IDX8079"></A>
<A NAME="IDX8080"></A>
<P>たとえば、通常アクセス権と禁止アクセス権が混在するためにユーザーのディレクトリーへのアクセスにそれらの相互作用がどう影響するか理解することが困難な場合などには、新しいアクセス権を定義する前に ACL を完全に消去するのが最も簡単な方法である場合があります。新規項目を定義するときに ACL を完全に消去するには、
<B>-clear</B> フラグを <B>fs setacl</B> コマンドに組み込みます。このフラグを組み込むと、ACL の通常アクセス権または禁止アクセス権のいずれかの機能グループに項目を作成できますが、両方の機能グループに一度に作成することはできません。
<P>ディレクトリーの所有者に適切なアクセス権を付与する項目を作成することを忘れないでください。所有者は、削除した項目を置換するために必要な <B>a</B>
(<B>管理</B>) アクセス権を暗黙的に持っていますが、欠落した ACL 項目 (特に <B>ルックアップ</B>権の欠如) の影響により、所有者が混乱するので、項目の欠落が問題となることを認識するのが困難になります。
<A NAME="IDX8081"></A>
<A NAME="IDX8082"></A>
<P><H3><A NAME="Header_645" HREF="auagd002.htm#ToC_645">ACL を完全に置換する</A></H3>
<OL TYPE=1>
<LI>ACL を編集する各ディレクトリーに <B>a</B> (<B>管理</B>) 権があることを確認します。必要に応じて、<B>fs listacl</B> コマンドを発行します。これについては、
<A HREF="#HDRWQ788">ACL の表示</A> で詳しく説明しています。
<P>
<PRE>   % <B>fs listacl</B> [&lt;<VAR>dir/file path</VAR>>]
</PRE>
</LI><LI><B>fs setacl</B> コマンドに <B> -clear</B> フラグを組み込んで発行し、通常アクセス権または禁止アクセス権を設定する前に、ACL を完全に消去します。ディレクトリーの所有者にはすべての権限を付与することが必要なので、この時点では normal permissions を設定することが多くの場合最適です。
<P>
<PRE>   % <B>fs setacl -dir</B> &lt;<VAR>directory</VAR>><SUP>+</SUP> <B>-acl</B> &lt;<VAR>access list entries</VAR>><SUP>+</SUP> <B>-clear</B>  \
               [<B>-negative</B>] 
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>sa
</B><DD>は、<B>setacl</B> の受け入れ可能な別名です
(<B>seta</B> は受け入れ可能な最も短い省略形です)。
<P><DT><B>-dir
</B><DD><B>-acl</B> 引き数によって定義された ACL 禁止項目に適用する、1 つまたは服すのディレクトリーを指定します。各ディレクトリーに読み取り / 書き込みパスを指定して、読み取り専用ボリュームを変更しようとするときに障害が発生するのを防ぎます。受け入れ可能な値の詳細については、
<A HREF="#HDRWQ790">ACL 通常アクセス権を追加、削除、または編集するには</A>を参照してください。
<P><DT><B>-acl
</B><DD>1 つまたは複数の ACL 項目を指定します。各項目は、ユーザーまたはグループ名、アクセス権のセットが対になっています。1 つまたは複数のスペースを入れて、対を分離し、各対を 2 つの部分にします。ディレクトリーの所有者にすべてのアクセス権を付与することを忘れないでください。受け入れ可能な値の詳細については、
<A HREF="#HDRWQ790">ACL 通常アクセス権を追加、削除、または編集するには</A> を参照してください。
<P><DT><B>-clear
</B><DD><B>-acl</B> 引き数で指定した項目を作成する前に、各 ACL からすべての項目を削除します。
<P><DT><B>-negative
</B><DD><B>-acl</B> 引き数によって定義した項目を、ACL の禁止アクセス権機能グループに配置します。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ793" HREF="auagd002.htm#ToC_646">ディレクトリー間で ACL をコピー</A></H2>
<A NAME="IDX8083"></A>
<A NAME="IDX8084"></A>
<A NAME="IDX8085"></A>
<P><B>fs copyacl</B> コマンドは、送信元ディレクトリーの ACL を 1 つ以上のあて先ディレクトリーにコピーします。その場合、送信元 ACL は全く影響を受けません。しかし、各あて先 ACL は次のように変更します。
<UL>
<LI>送信元 ACL 上の項目が、まだあて先 ACL 上に存在していない場合、このコマンドはそれをあて先 ACL にコピーします。
</LI><LI>あて先 ACL 上の項目が送信元 ACL 上に存在しない場合も、<B> -clear</B> フラグを組み込んで、あて先 ACL を完全に上書きしないかぎり、このコマンドによってあて先 ACL の項目が削除されることはありません。
</LI><LI>項目が両用の ACL 上に存在する場合、このコマンドはあて先 ACL 項目上のアクセス権を変更し、送信元 ACL の項目に一致させます。
</LI></UL>
<P><B>AFS/DFS 移行ツールキット・ユーザーへの注意:</B>ユーザーが AFS/DFS 移行ツールキット経由で DCE セルの DFS ファイル・スペースにアクセスできるようにマシンが構成されている場合は、<B> fs copyacl</B> コマンドを使用して、DFS ファイルおよびディレクトリー上に ACL リストをコピーすることもできます。コマンドには、<B>-id</B> および <B> -if</B> フラグが組み込まれているので、正規の ACL だけでなく、DFS ディレクトリーの初期コンテナーおよび初期オブジェクトを更新できます。<I>AFS/DFS Migration Toolkit Administration Guide and Reference</I> を参照してください。AFS ディレクトリーおよび DFS ディレクトリー間では ACL はコピーできません。使用している ACL 形式が異なるからです。<B> fs</B> コマンド・インタープリターでは、AFS ACL のコピー時に組み込まれていても、<B>-id</B> および <B>-if</B> フラグは無視されます。
<A NAME="IDX8086"></A>
<A NAME="IDX8087"></A>
<P><H3><A NAME="Header_647" HREF="auagd002.htm#ToC_647">ディレクトリー間で ACL をコピーする</A></H3>
<OL TYPE=1>
<LI><B>l</B> (<B>ルックアップ</B>) アクセス権が送信元 ACL に存在し、<B>a</B> (<B>管理</B>) アクセス権がそれぞれのあて先 ACL 上に存在することを確認します。ファイル名を指定して送信元ディレクトリーを識別するには、送信元の ACL 上に <B>r</B> (<B>読み取り</B>) アクセス権も持っていなくてはなりません。必要に応じて、<B>fs listacl</B> コマンドを発行します。これについては、<A HREF="#HDRWQ788">ACL の表示</A> で詳しく説明しています。
<P>
<PRE>   % <B>fs listacl</B> [&lt;<VAR>dir/file path</VAR>>]
</PRE>
</LI><LI><A NAME="LIWQ794"></A><B>fs copyacl</B> コマンドを発行して、送信元 ACL を 1 つ以上のあて先 ディレクトリーの ACL にコピーします。(コマンドは、ただ見やすくするために 2 行に表示されています)。
<P>
<PRE>   % <B>fs copyacl -fromdir</B> &lt;<VAR>source directory</VAR>>
                <B>-todir</B> &lt;<VAR>destination directory</VAR>><SUP>+</SUP>  \
                [<B>-clear</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>co
</B><DD>は、<B>copyacl</B> の最も短い受け入れ可能な省略形です。
<P><DT><B>-fromdir
</B><DD>ACL をコピーする送信元ディレクトリーの名前を指定します。パス名の一部は、現行作業ディレクトリーとの関連で解釈されます。この引き数がファイルを指定している場合、そのディレクトリーから ACL がコピーされます。
<P><DT><B>-todir
</B><DD>送信元 ACL をコピーする各あて先ディレクトリーの名前を指定します。パス名の一部は、現行作業ディレクトリーとの関連で解釈されます。ファイル名は受け入れ不可です。
<P>
<P>各ディレクトリーに読み取り / 書き込みパスを指定して、読み取り専用ボリュームを変更しようとするときに障害が発生するのを防ぎます。規則では、パス名の第 2 レベルのセル名の前にピリオドを付けて、読み取り / 書き込みパスを指定します (たとえば、
<B>/afs/.abc.com</B>)。ファイル・スペースの読み取り / 書き込みパス、および読み取り専用パスの概念についての詳細は、
<A HREF="auagd010.htm#HDRWQ295">マウント・ポイント横断の規則</A> を参照してください。
<P><DT><B>-clear
</B><DD>それぞれのあて先ディレクトリーの ACL を送信元 ACL で上書きします。
</DL>
</LI></OL>
<P>以下の例では、ACL を、現行作業ディレクトリーの <B>notes</B> サブディレクトリーから <B>plans</B> サブディレクトリーにコピーしています。発行者が <B>-clear</B> フラグを組み込まないので、<B>notes</B> ディレクトリーの ACL 上に対応する項目はありませんが、ユーザー <B> pat</B> の項目は <B>plans</B> ディレクトリーの ACL 上に残しておきます。
<PRE>   % <B>fs la notes plans</B>
   Access list for notes is
   Normal permissions:
     terry rlidwka
      smith rl
      jones rl
   Access list for plans is
   Normal permissions:
      terry rlidwk
      pat rlidwk
   % <B>fs copyacl notes plans</B>
   % <B>fs la notes plans</B>
   Access list for notes is
   Normal permissions:
      terry rlidwka
      smith rl
      jones rl
   Access list for plans is
   Normal permissions:
      terry rlidwka
      pat rlidwk
      smith rl
      jones rl
</PRE>
<A NAME="IDX8088"></A>
<A NAME="IDX8089"></A>
<A NAME="IDX8090"></A>
<A NAME="IDX8091"></A>
<A NAME="IDX8092"></A>
<HR><H2><A NAME="HDRWQ795" HREF="auagd002.htm#ToC_648">古くなった AFS ID を ACL から除去する</A></H2>
<P>保護データベースからユーザーまたはグループの項目を削除しようとすると、<B>fs listacl</B> コマンドにより、名前ではなく ACL 項目のユーザーの AFS UID (またはグループの AFS GID) が表示されます。次の例では、ユーザー <B>terry</B> が、グループ <B>terry:friends</B> (AFS GID -567) の ACL 項目を、
ABC Corporation セル内の自分のホーム・ディレクトリーに持っていて、そのグループを保護データベースから除去します。
<PRE>   % <B>fs listacl /afs/abc.com/usr/terry</B>
   Access list for /afs/abc.com/usr/terry is
   Normal permissions:
     terry:friends rlik
     system:anyuser l
     terry rlidwka
   % <B>pts delete terry:friends</B>
   % <B>fs listacl /afs/abc.com/usr/terry</B>
   Access list for /afs/abc.com/usr/terry is
   Normal permissions:
     -567 rlik
     system:anyuser l
     terry rlidwka
</PRE>
<P>AFS ID を ACL に残しても何も機能しません。その ID がもうアクティブ・ユーザーまたはグループに対応していないからです。さらに、ID が新規ユーザーまたはグループに割り当てられた場合、ID の新規所有者はディレクトリーの所有者が実際に前の所有者に対して設定したアクセスを使用します(このような理由から、AFS ID の再利用は、明確にお勧めしません)。
<P>使用されなくなった AFS ID を ACL から削除するには、<B>fs cleanacl</B> コマンドを使用します。
<A NAME="IDX8093"></A>
<A NAME="IDX8094"></A>
<P><H3><A NAME="Header_649" HREF="auagd002.htm#ToC_649">ACL から古くなった AFS ID を消去する</A></H3>
<OL TYPE=1>
<LI>ACL を消去する各ディレクトリーに <B>a</B> (<B>管理</B>) アクセス権があることを確認します。必要に応じて、<B>fs listacl</B> コマンドを発行します。これについては、<A HREF="#HDRWQ788">ACL の表示</A> で詳しく説明しています。
<P>
<PRE>   % <B>fs listacl</B> [&lt;<VAR>dir/file path</VAR>>]
</PRE>
</LI><LI>古くなった AFS ID から項目を削除するには、<B>fs cleanacl</B>コマンドを発行します。
<P>
<PRE>   % <B>fs cleanacl</B> [&lt;<VAR>dir/file path</VAR>><SUP>+</SUP>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>cl
</B><DD>は、<B>cleanacl</B> の最も短い受け入れ可能な省略形です。
<P><DT><B><VAR>dir/file path</VAR>
</B><DD>ACL を消去する各ディレクトリーを指定します。この引き数がファイルを指定している場合、そのディレクトリーの ACL が消去されます。この引き数を省略すると、現行作業ディレクトリーの ACL が消去されます。
<P>
<P>各ディレクトリーに読み取り / 書き込みパスを指定して、読み取り専用ボリュームを変更しようとするときに障害が発生するのを防ぎます。規則では、パス名の第 2 レベルのセル名の前にピリオドを付けて、読み取り / 書き込みパスを指定します (たとえば、
<B>/afs/.abc.com</B>)。ファイル・スペースの読み取り / 書き込みパス、および読み取り専用パスの概念についての詳細は、
<A HREF="auagd010.htm#HDRWQ295">マウント・ポイント横断の規則</A> を参照してください。
<P>
<P>パス名自体またはパス名の一部として、以下の表記を使用することもできます。
<P>
<DL>
<P><DT><B>.
</B><DD>(1 つのピリオド)。単独で使用すると、現行作業ディレクトリーが消去されます。
<P><DT><B>..
</B><DD>(2 つのピリオド)。単独で使用すると、現行作業ディレクトリーの親ディレクトリーが消去されます。
<P><DT><B>*
</B><DD>(アスタリスク)。現行作業ディレクトリー内の各サブディレクトリーの ACL を消去します。ただし、任意のディレクトリーの ACL に古い AFS IDがある場合にアスタリスクを使用すると、そのディレクトリー内のすべてのファイルに対して、次のメッセージが表示されます。
<P>
<PRE>   fs: '<VAR>filename</VAR>': Not a directory
</PRE>
</DL>
</DL>
</LI></OL>
<P>ディレクトリーに、古くなった AFS ID があると、コマンド・インタープリターにより、以下のヘッダーの下に消去された ACL が表示されます。
<PRE>   Access list for <VAR>directory</VAR> is now
</PRE>
<P>ディレクトリーの ACL に古くなった AFS ID がない場合、以下のメッセージがそのつど表示されます。
<PRE>   Access list for <VAR>directory</VAR> is fine.
</PRE>
<HR><H2><A NAME="HDRWQ796" HREF="auagd002.htm#ToC_650">AFS が UNIX モード・ビットを解釈する方法</A></H2>
<A NAME="IDX8095"></A>
<A NAME="IDX8096"></A>
<A NAME="IDX8097"></A>
<P>AFS は、UFS が使用するモード・ビットではなく、ACL を使用してファイル・データを保護しますが、モード・ビットを完全に無視しているわけではありません。
<B>chmod</B> コマンドを AFS ファイルまたはディレクトリーに対して発行すると、AFS は、ビットを適切に変更します。ファイルのモード・ビットを変更するためには、ファイルのディレクトリーの ACL 上に AFS の <B>w</B> (<B>書き込み</B>) 権が必要です。ディレクトリーのモード・ビットを作成するには、ACL 上に、
<B>d</B> (<B>削除</B>)、
<B>i</B> (<B>挿入</B>)、および <B>l</B> (<B>ルックアップ</B>) アクセス権がなければなりません。
<P>また、AFS は、UNIX モード・ビットを以下のように使用します。
<UL>
<LI>AFS は、初期ビットを使用して、要素のタイプを指定します。<B>ls -l</B> コマンドによる出力では、このビットが最初に表示され、ハイフン (<B>-</B>) がファイルを示し、
<B>d</B> という文字がディレクトリーを示します。
</LI><LI>ディレクトリー上のモード・ビットはいずれも使用されません。
</LI><LI>ファイルの場合、ビットの最初の
(所有者) セットは、以下の方法で、ファイルに適用される ACL 項目と相互作用します。
<UL>
<LI>最初の <B>r</B> モード・ビットが設定されていない場合は、ACL 上にどんなアクセス権を持っていようとも、だれも (所有者も含め) そのファイルを読み取ることはできません。ビットが設定されている場合、ユーザーは、ファイルを読み取るために、ファイルのディレクトリーの ACL 上での <B>r</B> (<B>読み取り</B>) および <B>l</B> アクセス権も必要です
</LI><LI>最初の <B>w</B> モード・ビットが設定されていない場合は、だれも (所有者も含め) そのファイルを読み取ることはできません。
<B>w</B>ビットが設定されている場合、ユーザーは、ファイルを変更するために、ファイルのディレクトリーの ACL 上での
<B>w</B> および <B>l</B> アクセス権も必要です
</LI><LI><B>x</B> モード・ビットに直接対応する ACL アクセス権はありませんが、
AFS に保管されているファイルを実行するために、ユーザーは、ファイルのディレクトリーの ACL 上での <B>r</B> および
<B>l</B> アクセス権も必要です。
</LI></UL>
</LI></UL>
<P><HR><B>&#91; <A HREF="#Top_Of_Page">ページのトップ</A> &#124; <A HREF="auagd019.htm">前ページ</A> &#124; <A HREF="auagd021.htm">次ページ</A> &#124; <A HREF="auagd002.htm#ToC">目次</A> &#124; <A HREF="auagd026.htm#HDRINDEX">索引</A> &#93;</B> 
<!-- Begin Footer Records  ========================================== -->
<P><HR><B> 
<br>(C) <A HREF="http://www.ibm.com/">IBM Corporation 2000.</A>  All Rights Reserved<!-- 991224 --> 
</B> 
<!-- End Footer Records  ============================================ -->
<A NAME="Bot_Of_Page"></A>
</BODY></HTML>
