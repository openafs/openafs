<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3//EN">
<HTML><HEAD>
<TITLE>管理の手引き</TITLE>
<!-- Begin Header Records  ========================================== -->
<!-- E:\IDWB\TEMP\idwt2118\AUAGD000.SCR converted by idb2h R4.2 (359) -->
<!-- ID Workbench Version (OS2) on 24 Dec 1999 at 12:07:32            -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Shift_JIS">
<META HTTP-EQUIV="updated" CONTENT="Fri, 24 Dec 1999 12:07:30">
<META HTTP-EQUIV="review" CONTENT="Sun, 24 Dec 2000 12:07:30">
<META HTTP-EQUIV="expires" CONTENT="Mon, 24 Dec 2001 12:07:30">
</HEAD><BODY>
<!-- (C) IBM Corporation 2000. All Rights Reserved    --> 
<BODY bgcolor="ffffff"> 
<!-- End Header Records  ============================================ -->
<A NAME="Top_Of_Page"></A>
<H1>管理の手引き</H1>
<HR><H1><A NAME="HDRWQ177" HREF="auagd002.htm#ToC_164">サーバー・プロセスの監視および制御</A></H1>
<A NAME="IDX6242"></A>
<A NAME="IDX6243"></A>
<P>システム管理者として最も重要な役割の 1 つは、ファイル・サーバー・マシンのプロセスが正しく稼働していることを確認することです。各ファイル・サーバー・マシン上で稼働する BOS サーバーは、そのマシン上の他の AFS サーバー・プロセスを絶えず監視することによって、ユーザーを多くの責任から解放します。BOS サーバーは失敗したプロセスを自動的に再始動することができ、相互依存性を考慮に入れた再始動が行なわれるよう指示します。
<P>異なるファイル・サーバー・マシンは異なるプロセスの組み合わせを実行するため、各ファイル・サーバー・マシン上の BOS サーバーが監視するプロセスを定義する必要があります (その方法については、<A HREF="#HDRWQ201">プロセス状況の制御および検査</A> を参照してください)。
<P>サーバー・プロセス状況を直接制御して、ルーチン・メインテナンスを実行するか、BOS サーバーが訂正できない問題を訂正する必要があるかもしれません (たとえばデータベースの複写または相互認証に関する問題)。その場合、<B>bos</B> コマンドの発行によって、
BOS サーバーを介してプロセス状況を制御します。
<HR><H2><A NAME="HDRWQ178" HREF="auagd002.htm#ToC_165">命令の要約</A></H2>
<P>この章では、指示されたコマンドを使用して次のタスクの実行する方法を説明します。
<BR>
<TABLE WIDTH="100%">
<TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">プロセス状況を検査する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos status</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%"><B>BosConfig file</B> ファイルの情報を検査する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos status</B> (<B>-long</B> フラグ付き)
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">プロセス・インスタンスを作成する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos create</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">プロセスを停止する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos stop</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">停止したプロセスを開始する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos start</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">プロセスを一時的に停止する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos shutdown</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">一時的に停止したプロセスを開始する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos startup</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">プロセスを停止し、即時に再始動する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos restart</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">すべてのプロセスを停止し、即時に再始動する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos restart</B> (<B>-bosserver</B> フラグ付き)
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">BOS サーバーの再始動時を検査する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos getrestart</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">BOS サーバーの再始動時を設定する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos setrestart</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">ログ・ファイルを検査する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos getlog</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="58%">コマンドをリモートで実行する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="42%"><B>bos exec</B>
</TD></TR></TABLE>
<HR><H2><A NAME="HDRWQ192" HREF="auagd002.htm#ToC_166">AFS サーバー・プロセスの要旨</A></H2>
<P>このセクションでは、ファイル・サーバー・マシン上で実行することができるさまざまなサーバー・プロセスについて簡単に説明します。複数のファイル・サーバー・マシンがあるセルでは、すべてのプロセスがすべてのマシン上で稼働するわけではありません。
<P>AFS サーバー・プロセスは、コンテキストによっては、3 つのうちのいずれかの方法で参照します。
<A NAME="IDX6244"></A>
<UL>
<LI><B>bos status</B> コマンドの出力は、<B>bos create</B> コマンドが <B>/usr/afs/local/BosConfig</B> ファイルでそのエントリーを作成するときに割り当てた名前でプロセスを参照します。名前はマシンによって違うこともありますが、すべてのマシンに同じ名前を割り当てるとセルの管理が容易になります。<I>AFS インストールの手引き</I> および <B>bos create</B> コマンドの参照ページには、一般的な名前がリストされています。プロセス名の例として、<B>bosserver</B>、<B>kaserver</B>、および <B>vlserver</B> があります。
</LI><LI>標準 <B>ps</B> コマンドによって作成されるプロセス・リストは、通常、プロセスのバイナリー・ファイルに一致します。プロセス・バイナリー・ファイルの例として、
<B>/usr/afs/bin/bosserver</B>、<B>/usr/afs/bin/kaserver</B>、および <B>/usr/afs/bin/vlserver</B> があります。
</LI><LI>このドキュメンテーションのほとんどのリファレンスを含むほとんどの文脈で、プロセスは (たとえば) <B>Basic OverSeer (BOS) Server</B>、<B>Authentication Server</B> または <B> Volume Location Server</B> といいます。
</LI></UL>
<P>次の機能グループは、各プロセスに対する名前、およびプロセスを使用する管理タスクの一部を指定します。サーバーについてのより一般的な説明については、<A HREF="auagd006.htm#HDRWQ18">AFS サーバー・プロセスとキャッシュ・マネージャー</A> を参照してください。
<P><H3><A NAME="HDRWQ193" HREF="auagd002.htm#ToC_167">bosserver プロセス: Basic OverSeer サーバー</A></H3>
<A NAME="IDX6245"></A>
<A NAME="IDX6246"></A>
<P>各 AFS サーバー・マシン上で稼働する <B>bosserver</B> プロセスは、そのマシン上で稼働する他の AFS サーバー・プロセスを監視する役割がある Basic OverSeer (BOS) サーバーです。プロセスに障害が発生すると、BOS サーバーは、それを人間のオペレーターの介入なしに自動的に再始動することができます。複数のコンポーネント・プロセスを持つプロセスを再始動する場合、相互依存を考慮する必要があります (たとえば、<A HREF="#HDRWQ195">プロセスのコレクション: ファイル・サーバー、ボリューム・サーバーおよびサルベージャー</A> で説明されている <B>fs</B> プロセス)。
<A NAME="IDX6247"></A>
<P>BOS サーバーは、それ自体を監視および再始動できないため、<B>bos status</B> コマンドの出力には表示されません。<TT>/usr/afs/bin/bosserver</TT>として <B>ps</B> コマンドの出力で表示されます。
<A NAME="IDX6248"></A>
<A NAME="IDX6249"></A>
<P>システム管理者として、次のタスクを実行するために <B>bos</B> コマンドを発行するときに BOS サーバーと連絡します。
<A NAME="IDX6250"></A>
<UL>
<LI><A HREF="#HDRWQ201">プロセス状況の制御および検査</A> で説明してあるように、<B>/usr/afs/local/BosConfig</B> ファイルで項目を作成して BOS サーバーが監視するプロセスの定義。
</LI><LI>この章の後に示す指示に従って、ファイル・サーバー・マシン上のプロセスの停止および開始。
</LI><LI><A HREF="auagd008.htm#HDRWQ153">サーバー CellServDB ファイルの保守</A>で説明してあるように、<B> /usr/afs/etc/CellServDB</B> ファイルでのセルのデータベース・サーバー・マシンの定義。
</LI><LI><A HREF="auagd014.htm#HDRWQ478">サーバー暗号化鍵の管理</A>に説明してあるように、<B>/usr/afs/etc/KeyFile</B> ファイルでの AFS 暗号化鍵の定義
</LI><LI><A HREF="auagd021.htm#HDRWQ815">UserList ファイルの管理</A>に説明してあるように、ユーザーを<B> /usr/afs/etc/UserList</B> ファイルに追加することによって、BOS サーバー、ボリューム・サーバー、およびバックアップ・サーバーのオペレーションに関してシステム管理者特権の付与
</LI><LI><A HREF="auagd008.htm#HDRWQ158">認証と許可の要件の管理</A>に説明してあるように、サーバー・マシン上認証チェック要件の設定
</LI></UL>
<P><H3><A NAME="HDRWQ194" HREF="auagd002.htm#ToC_168">buserver プロセス: バックアップ・サーバー</A></H3>
<A NAME="IDX6251"></A>
<A NAME="IDX6252"></A>
<P>データベース・サーバー・マシン上で稼働する <B>buserver</B> プロセスは、バックアップ・サーバーです。このプロセスは、バックアップ・システム構成およびバックアップ・データベースのオペレーションについての情報を管理します。
<P>プロセスは、一般的な名前が割り当てられている場合、<B>bos status</B> コマンドの出力で <TT>buserver</TT> のように表示されます。<TT>/usr/afs/bin/buserver</TT> として <B>ps</B> コマンドの出力で表示されます。
<A NAME="IDX6253"></A>
<A NAME="IDX6254"></A>
<P>システム管理者として、バックアップ・システム構成情報を変更するもの、ボリュームから永久記憶域にデータをダンプするもの、またはデータを AFS に回復するものなどを含む、バックアップ・データベースの情報を操作する <B>backup</B> コマンドを発行するときにバックアップ・サーバーに接触します。
<A HREF="auagd011.htm#HDRWQ334">AFS バックアップ・システムの構成</A> および <A HREF="auagd012.htm#HDRWQ383">AFS データのバックアップと復元</A>を参照してください。
<P><H3><A NAME="HDRWQ195" HREF="auagd002.htm#ToC_169">プロセスのコレクション: ファイル・サーバー、ボリューム・サーバーおよびサルベージャー</A></H3>
<A NAME="IDX6255"></A>
<A NAME="IDX6256"></A>
<P>各ファイル・サーバー・マシン上で稼働する <B>fs</B> プロセスは、
3 つのコンポーネント・プロセス、すなわちファイル・サーバー、ボリューム・サーバー、およびサルベージャーを結合します。
3 つのコンポーネントは、独立した機能を実行しますが、次の理由から単一プロセスとして制御されます。
<UL>
<LI>これらはすべて同じデータで、すなわち AFS ボリュームに格納されているファイルおよびディレクトリーで動作します。これらを単一プロセスとして結合すると、そのアクションを調整することができますが、同じデータで同時にオペレーションを行わないでください。データが破壊されることもあります。
</LI><LI>BOS サーバーは、要求された順序でプロセスを停止、再始動することができます。ファイル・サーバーが失敗すると、BOS サーバーはボリューム・サーバーを停止し、サルベージャーを稼働して、その障害によって生じた破壊を訂正します。
(サルベージャーは、この特別な状況、または <B>bos salvage</B> コマンドを使用して、ユーザー自身が呼び出した場合にのみ稼働します。
<A HREF="auagd010.htm#HDRWQ318">ボリュームのサルベージ</A> を参照してください。) ボリューム・サーバーのみが障害を発生した場合、BOS サーバーは、ファイル・サーバーまたはサルベージャーに影響を与えずに再始動することができます。
</LI></UL>
<P>ファイル・サーバー・コンポーネントは、ファイルおよびディレクトリーのレベルで AFS データを処理して、アプリケーション・プログラムおよび標準のオペレーティング・システム・コマンドで要求されたときにファイル・システム要素を操作します。主な役割は、クライアント・マシンに要求ファイルを送達し、クライアントが使い終わると、それを再びサーバー・マシンに格納することです。また、各ファイルおよびディレクトリーに関する状況および保護情報も保持します。通常の操作中は、連続的に稼働します。
<A NAME="IDX6257"></A>
<P>ボリューム・サーバー・コンポーネントは、ファイルおよびディレクトリーのレベルではなく、ボリューム全体のレベルで AFS データを処理します。<B>vos</B> コマンドへの応答として、他のアクション間で、ボリューム全体を作成、削除、移動、ダンプおよび復元します。通常の操作中は、連続的に稼働します。
<A NAME="IDX6258"></A>
<P>サルベージャー・コンポーネントは、他の 2 つのプロセスのうちの 1 つが失敗したあとにのみ稼働します。このコンポーネントは、内部整合性についてファイル・システムを検査して、エラーが見付かった場合にはそれを修理します。
<A NAME="IDX6259"></A>
<A NAME="IDX6260"></A>
<P>プロセスは、一般的な名前が割り当てられている場合、<B>bos status</B> コマンドの出力で <TT>fs</TT> のように表示されます。補助メッセージは、ファイル・サーバーまたはサルベージャー・コンポーネントの状況をレポートします。<A HREF="#HDRWQ205">BosConfig ファイルのプロセス状況および情報の表示</A>を参照してください。
<P><B>fs</B> プロセスのコンポーネント・プロセスは、次のように、<B>ps</B> コマンドの出力で個別に表示されます。<TT>fs</TT> プロセスそのものには、項目がありません。
<UL>
<LI><TT>/usr/afs/bin/fileserver</TT>
</LI><LI><TT>/usr/afs/bin/volserver</TT>
</LI><LI><TT>/usr/afs/bin/salvager</TT>
</LI></UL>
<P>キャッシュ・マネージャーは、AFS ファイルまたはディレクトリーにあるデータまたはステータス情報をアクセスするとき、または UNIX <B>cp</B> および <B>ls</B> コマンドのようなファイル操作コマンドを発行するときには、ユーザー自身のためにファイル・サーバー・コンポーネントに接触します。次の機能を実行する <B>fs</B> コマンドを発行すると、ファイル・サーバーに直接接触することができます。
<A NAME="IDX6261"></A>
<A NAME="IDX6262"></A>
<UL>
<LI><A HREF="auagd020.htm#HDRWQ773">アクセス制御リスト (ACL) の管理</A>で説明してあるように、ファイル・システム内のあるどれかのディレクトリーの ACL を管理する。
</LI><LI>AFS ボリュームを収容するための新規パーティションの導入、この場合には新規パーティションを認識できるようにするため <B>fs</B> プロセスを再起動する必要があります。説明は、<A HREF="auagd008.htm#HDRWQ165">ディスクと区分の追加または除去</A>を参照してください。
</LI><LI><A HREF="auagd010.htm#HDRWQ294">ボリュームの取り付け</A>に説明してあるように、AFS ファイル・スペース内でのボリューム・マウントの作成と削除
</LI><LI><A HREF="auagd010.htm#HDRWQ320">ボリューム割り当て量および現行サイズの設定および表示</A>に説明してあるように、ボリューム割り当ての設定およびボリュームまたはパーティションで利用可能なスペースについての情報の表示
</LI></UL>
<A NAME="IDX6263"></A>
<A NAME="IDX6264"></A>
<P>作成、除去、複写、移動、名前変更、異なるフォーマットへの変換、およびサルベージのいずれかの方法でボリュームを操作する <B>vos</B> コマンドを発行するときボリューム・サーバー・コンポーネントと接触します。説明については、
<A HREF="auagd010.htm#HDRWQ229">ボリュームの管理</A>を参照してください。
<P>通常、サルベージャーは障害があった場合に自動的に稼働します。
<A HREF="auagd010.htm#HDRWQ318">ボリュームのサルベージ</A> で説明してあるように、<B>bos salvage</B> コマンドで始動することもできます。
<A NAME="IDX6265"></A>
<A NAME="IDX6266"></A>
<P><H3><A NAME="HDRWQ196" HREF="auagd002.htm#ToC_170">kaserver プロセス: 認証サーバー</A></H3>
<A NAME="IDX6267"></A>
<A NAME="IDX6268"></A>
<P>データベース・サーバー・マシン上で稼働する <B>kaserver</B> プロセスは、
AFS セキュリティーのいくつかの局面に対して責任を負う認証サーバーです。このサーバーは、パスワードを要求して AFS ユーザー識別を検証します。認証データベース内のすべての AFS サーバーの暗号化鍵およびユーザー・パスワードを保持します。認証サーバーのチケット付与サービス (TGS) モジュールは、セキュア・コネクションを確立するとき AFS クライアントおよびサーバーが処理する共有シークレットを作成します。
<P>プロセスは、一般的な名前が割り当てられている場合、<B>bos status</B> コマンドの出力で <TT>kaserver</TT> のように表示されます。文字列 <B>ka</B> は、<I>Kerberos 認証 (Kerberos Authentication)</I> を意味し、
AFS 認証プロトコルはマサチューセッツ工科大学のプロジェクト Athena によって開発された Kerberos を基礎としていることを表しています。
<P><TT>/usr/afs/bin/kaserver</TT> として <B>ps</B> コマンドの出力で表示されます。
<A NAME="IDX6269"></A>
<A NAME="IDX6270"></A>
<P>システム管理者として、次のタスクを実行するために <B>kas</B> コマンドを発行するときに認証サーバーと接触します。
<UL>
<LI>ユーザー・パスワードの設定。<A HREF="auagd018.htm#HDRWQ693">AFS ユーザー・アカウントの作成</A> および <A HREF="auagd018.htm#HDRWQ707">AFS パスワードの変更</A> で説明してあるように、通常、ユーザーは自身のパスワードを変更するので、新規のユーザー・アカウントを作成したときにだけこのタスクを実行します。
</LI><LI>TGS がサーバー・チケットの保証に使用する認証データベースでAFS サーバー暗号化鍵の設定。<A HREF="auagd014.htm#HDRWQ478">サーバー暗号化鍵の管理</A>を参照してください。
</LI><LI><A HREF="auagd021.htm#HDRWQ812">kas コマンドに対する特権付与:  ADMIN フラグ</A>に説明してあるように、認証サーバーに関してシステム管理者特権の付与または取り消し。
</LI></UL>
<P><H3><A NAME="HDRWQ197" HREF="auagd002.htm#ToC_171">ptserver プロセス: 保護サーバー</A></H3>
<A NAME="IDX6271"></A>
<A NAME="IDX6272"></A>
<P>データベース・サーバー・マシン上で稼働する <B>ptserver</B> プロセスは、保護サーバーです。その主な役割は、ユーザー、マシンおよびグループ項目を含む保護データベースの保持です。保護サーバーは、AFS ID を割り当てて、ID と名前間のマッピングを保持します。ファイル・サーバーは、要求されたアクションをユーザーが実行する権限があるかを検証するときに保護サーバーに相談します。
<P>プロセスは、一般的な名前が割り当てられている場合、<B>bos status</B> コマンドの出力で <TT>ptserver</TT> のように表示されます。<TT>/usr/afs/bin/ptserver</TT>として <B>ps</B> コマンドの出力で表示されます。
<A NAME="IDX6273"></A>
<A NAME="IDX6274"></A>
<P>システム管理者として、次のタスクを実行するために <B>pts</B> コマンドを発行するときに保護サーバーと接触します。<UL>
<LI><A HREF="auagd019.htm#HDRWQ722">保護データベースの管理</A>に説明してあるように、保護データベースでの新規ユーザー、マシンまたはグループ項目の作成
</LI><LI><A HREF="auagd019.htm#HDRWQ722">保護データベースの管理</A>に説明してあるように、グループ・メンバーの追加または削除、または保護データベース項目の操作
</LI><LI><A HREF="auagd021.htm#HDRWQ809">system:administrators グループの管理</A>に説明してあるように、<B>system:administrators</B> グループのメンバーシップを変更することによるシステム管理者特権の付与または取り消し
</LI></UL>
<P><H3><A NAME="HDRWQ198" HREF="auagd002.htm#ToC_172">runntp プロセス</A></H3>
<A NAME="IDX6275"></A>
<A NAME="IDX6276"></A>
<A NAME="IDX6277"></A>
<P><B>runntp</B> プロセスは、すべてのサーバー・マシン上で稼動するネットワーク・タイム・プロトコル・デーモン (NTPD) の制御プログラムで、サーバー・マシン上にあるハードウェア・クロックを同期させます。NTP または別のタイム同期化プロトコルをサーバー・マシン上でまだ稼動していない場合には、<B>runntp</B>プロセスを実行する必要があります。
<P>データベース・サーバー・マシン上のクロックは、AFS の分散データベース・テクノロジー (Ubik) は、振動の狭い範囲内でクロックが一致するときのみ正しく動作するため、データベース・サーバー・マシン上のクロックは同期する必要があります (<A HREF="auagd008.htm#HDRWQ138">Ubik の適切なオペレーションのためのセル構成</A>を参照 )。ファイル・サーバーはファイル上の変更タイム・スタンプを設定するだけではなく、通常の構成では AFS クライアント・マシンのタイム・ソースとなるため、ファイル・サーバー・マシン上のクロックは正確にする必要があります。
<P>プロセスは、一般的な名前が割り当てられている場合、<B>bos status</B> コマンドの出力で <TT>runntp</TT> のように表示されます。それは、<TT>/usr/afs/bin/runntp</TT> として <B>ps</B> コマンドの出力に表示されます。<B>ps</B> コマンドの出力には、<TT>ntpd</TT> という項目も含まれます。その正確な形式は、<B>runntp</B> コマンドに設定する引き数によって違います。
<A NAME="IDX6278"></A>
<A NAME="IDX6279"></A>
<P><I>AFS インストールの手引き</I>の指示に従って、システム管理者は、いったんインストールされた NTPD には直接接触することはありません。
<P><H3><A NAME="HDRWQ199" HREF="auagd002.htm#ToC_173">upserver および upclient プロセス: 更新サーバー</A></H3>
<A NAME="IDX6280"></A>
<A NAME="IDX6281"></A>
<A NAME="IDX6282"></A>
<P>アップデート・サーバーには 2 つの分離パーツがあり、各パーツは異なるタイプのファイル・サーバー・マシン上で稼働します。<B>upserver</B> プロセスは、更新サーバーのサーバー部分です。その機能は、ユーザーが使用する AFS の版によって違います。
<UL>
<LI>米国版と国際版両方で、ユーザーがサーバー・マシンとして使用する各システム・タイプのバイナリー配布マシンで稼動して、互いの <B>/usr/afs/bin</B> ディレクトリーの内容をそのタイプの他のサーバー・マシンに配布します。これによって、すべてのマシンが AFS バイナリーの同じバージョンを持つことが保証されます。(バイナリーのリストは、<A HREF="auagd008.htm#HDRWQ119">/usr/afs/bin ディレクトリーにあるバイナリー</A> を参照してください。)
</LI><LI>AFS の米国版を使用する場合、セルのシステム制御マシン上で稼働して、その <B>/usr/afs/etc</B> ディレクトリーの内容を他のすべてのファイル・サーバー・マシン上に配布してそのディレクトリーに保管されている構成ファイルと同期します。(構成ファイルのリストは、<A HREF="auagd008.htm#HDRWQ120">/usr/afs/etc ディレクトリーにある共通構成ファイル</A>を参照してください。)
</LI></UL>
<P><B>upclient</B> プロセスは更新サーバーのクライアント部分で、サーバー部分のように、その機能は使用する AFS 版によって違います。
<UL>
<LI>バイナリー配布マシンではないすべてのサーバー・マシン上で稼動して、そのシステム・タイプのバイナリー配布マシンを <B>/usr/afs/bin</B> ディレクトリーにあるバイナリーへの更新元として参照します。割り当てるための通常のプロセス名は、<B>upclientbin</B> です。
</LI><LI>米国版の AFS を使用する場合には、プロセスの別のインスタンスは、システム制御マシンを除いてすべてのサーバー・マシン上で稼動します。これは、
<B>/usr/afs/etc</B> ディレクトリー内の共通構成ファイルに対する更新のソースとして、システム制御マシンを参照します。割り当てるための通常のプロセス名は、<B>upclientetc</B> です。
</LI></UL>
<P><B>bos status</B> コマンドの出力では、通常の名前が割り当てられている場合、サーバー部分は <TT>upserver</TT> のようになり、クライアント部分は <TT>upclientbin</TT> と <TT>upclientetc</TT> のようになります。<B>ps</B> コマンドからの出力では、サーバー部分は、<TT>/usr/afs/bin/upserver</TT> として表示されますが、クライアント部分は <TT>/usr/afs/bin/upclient</TT> として表示されます。
<A NAME="IDX6283"></A>
<A NAME="IDX6284"></A>
<P>システム管理者として、いったんインストールされた更新サーバーには、直接接触することはありません。配布するファイルを変更するために <B>bos</B> コマンドを使用するときには、自動的に動作します。
<P><H3><A NAME="HDRWQ200" HREF="auagd002.htm#ToC_174">vlserver プロセス: ボリューム・ロケーション・サーバー</A></H3>
<A NAME="IDX6285"></A>
<A NAME="IDX6286"></A>
<P>データベース・サーバー・マシン上で稼働する <B>vlserver</B> プロセスは、ファイル・システム内のすべてのボリュームを自動的に追跡するボリューム・ロケーション (VL) サーバーで、そのロケーションをクライアント・アプリケーションに対してトランスペアレントにします。
<P>プロセスは、一般的な名前が割り当てられている場合、<B>bos status</B> コマンドの出力で<TT>vlserver</TT>のように表示されます。<TT>/usr/afs/bin/vlserver</TT> として <B>ps</B> コマンドの出力で表示されます。
<A NAME="IDX6287"></A>
<A NAME="IDX6288"></A>
<A NAME="IDX6289"></A>
<P>システム管理者として、ボリュームの状況を変更する任意の <B>vos</B> コマンドを発行して、VL サーバーと接触します(VLDB 内の状況変化を記録します)。
<HR><H2><A NAME="HDRWQ201" HREF="auagd002.htm#ToC_175">プロセス状況の制御および検査</A></H2>
<P>サーバー・マシン上で稼動する AFS サーバー・プロセスを定義するには、<B>bos create</B> コマンドを使用してローカルの <B>/usr/afs/local/BosConfig</B> ファイルで項目を作成します。BOS サーバーは、<TT>Run</TT> ステータス・フラグでマークされている<B>BosConfig</B> ファイルにリストされているプロセスをモニターして、失敗した場合には自動的に再始動しようとします。処理入力を作成すると、プロセスを停止、開始するためまたは必要に応じて状況フラグを変更するために <B>bos</B> 組から他のコマンドを使用します。
<P><B>bos</B> コマンドを使用しないで <B>BosConfig</B> ファイルを直接編集しないでください。同様に、<B>BosConfig</B> ファイルにリストしないでサーバー・プロセスを実行したり、または UNIX <B>kill</B> コマンドのようなプロセス終了コマンドを使用して停止するのは、良い方法ではありません。
<P><H3><A NAME="Header_176" HREF="auagd002.htm#ToC_176">BosConfig ファイルの情報</A></H3>
<A NAME="IDX6290"></A>
<A NAME="IDX6291"></A>
<P><B>BosConfig</B> のプロセス項目には、次の情報が含まれています。
<UL>
<LI>プロセスの名前。推奨される一般的な名前は <I>AFS インストールの手引き</I> および <A HREF="#HDRWQ216">プロセスの作成および除去</A>で定義されています。単純なプロセスの名前は、通常、そのバイナリー・ファイルの名前に一致します (たとえば、保護サーバーの場合は、<B>ptserver</B>)。
</LI><LI>以下の 1 つであるそのタイプ: 
<DL>
<A NAME="IDX6292"></A>
<A NAME="IDX6293"></A>
<P><DT><B>simple
</B><DD>サーバー・マシン上の他のどれとも関係なく動作するプロセス。いくつかの単純プロセスが同時に失敗した場合、BOS サーバーは、どの順序でも再始動することができます。<B>fs</B> プロセス以外のすべての標準 AFS プロセスは、どれもシンプルです。
<P><DT><B>fs
<A NAME="IDX6294"></A>
<A NAME="IDX6295"></A>
<A NAME="IDX6296"></A>
<A NAME="IDX6297"></A>
<A NAME="IDX6298"></A>
</B><DD>通常名が <B>fs</B> でもあるサーバー・プロセスに予約されたプロセス・タイプ。このプロセスは、3 つのコンポーネント、すなわちファイル・サーバー、ボリューム・サーバー、およびサルベージャーを結合します。
<A NAME="IDX6299"></A>
<A NAME="IDX6300"></A>
<P><DT><B>cron
</B><DD>連続してではなく定義された時間に稼動するプロセス。このタイプには標準プロセスがありません。
</DL>
<A NAME="IDX6301"></A>
<A NAME="IDX6302"></A>
<A NAME="IDX6303"></A>
<A NAME="IDX6304"></A>
</LI><LI>プロセスに関して次の 2 つのアクションを実行するかどうかを BOS サーバーに通知するその状況フラグ。
<UL>
<LI>BOS サーバー初期化中のプロセスの開始
</LI><LI>(プロセスが) 失敗した場合に、プロセスの再始動
</LI></UL>
可能な 2 つの値は、<TT>Run</TT> (アクションを実行するように BOS サーバーに指示する) および <TT>NotRun</TT> (プロセスを無視するように BOS サーバーに指示する) です。BOS サーバーそのものは、プロセスが繰り返し失敗しても、このフラグの設定を変更することはありません。このフラグは内部使用専用です。<B>bos status</B> コマンドの出力には表示されません。
</LI><LI>そのコマンド・パラメーター。このパラメーターは、プロセスを始動するために BOS サーバーが実行するコマンドです。
<A NAME="IDX6305"></A>
<P>
<UL>
<LI>単純プロセスには 1 つあります。すなわち、そのバイナリー・ファイルへの完全パス名
</LI><LI><B>fs</B> プロセスには 3 つあります。すなわち、3 つのコンポーネント・プロセス (<B>/usr/afs/bin/fileserver</B>、<B>/usr/afs/bin/volserver</B> および <B> /usr/afs/bin/salvager</B>) それぞれに完全パス名
</LI><LI>cron プロセスには 2 つあります。すなわち、1 つはそのバイナリー・ファイルへの完全パス名で、もう 1 つは BOS サーバーが実行する時間
</LI></UL>
</LI></UL>
<P>プロセス定義以外に、<B>BosConfig</B> ファイルは、新規バイナリーがあるプロセスに対して、および BOS サーバーを含むすべてのサーバー・プロセスに対して自動再始動時間も記録します。<A HREF="#HDRWQ226">BOS サーバーの再始動時を設定する</A> を参照してください。
<P><H3><A NAME="HDRWQ202" HREF="auagd002.htm#ToC_177">BOS サーバーが BosConfig ファイルの情報を使用する方法</A></H3>
<A NAME="IDX6306"></A>
<A NAME="IDX6307"></A>
<A NAME="IDX6308"></A>
<P>BOS サーバーは、開始または再始動するたびに <B>BosConfig</B> ファイルを読み取って、開始およびモニターするプロセスを確認します。BOS サーバーは、情報をカーネル・メモリーに転送して、次に再始動するまで <B>BosConfig</B> ファイルの再読み取りはしません。
<B>BosConfig</B> ファイルには関係なく、BOS サーバーのメモリー状態を変更できることを意味します。たとえば、プロセスを停止しても <B>BosConfig</B> ファイル内の状況フラグを <TT>Run</TT> のままにしておくこともできますが、<B>BosConfig</B> ファイル内のその状況フラグが <TT>NotRun</TT> であってもプロセスを始動することができます。
<P><H3><A NAME="HDRWQ203" HREF="auagd002.htm#ToC_178">データベース・サーバー・プロセスの開始および停止について</A></H3>
<A NAME="IDX6309"></A>
<A NAME="IDX6310"></A>
<A NAME="IDX6311"></A>
<A NAME="IDX6312"></A>
<A NAME="IDX6313"></A>
<A NAME="IDX6314"></A>
<A NAME="IDX6315"></A>
<P>データベース・サーバー・プロセス (認証サーバー、バックアップ・サーバー、またはボリューム・ロケーション・サーバー)を一時的にではなく始動または停止するとき、データベース・サーバー・マシンをインストールまたは除去するためには <I>AFS インストールの手引き</I>の指示に従う必要があります。正しい AFS 機能を維持するために実行する必要のあるタスクの要約を以下に示します。
<UL>
<LI>そのマシン上の 4 つのデータベース・サーバー・プロセスすべてを開始し、停止する。すべての AFS サーバー・プロセスおよびキャッシュ・マネージャー・プロセスは、4 つのデータベース・サーバー・プロセスすべてが <B>CellServDB</B> ファイルにリストされている各マシンで稼動することを予期しています。マシンがデータベース・サーバー・プロセスの一部しか稼働していないことを示す方法はありません。
</LI><LI>すべてのサーバー・マシン上にある <B>/usr/afs/etc/CellServDB</B> ファイルにあるマシン、およびすべてのクライアント・マシン上にある <B>/usr/vice/etc/CellServDB</B> ファイルでマシンを追加または削除します。
</LI><LI>それぞれに対して新規 Ubik コーディネーターの選択を強制するには、他のデータベース・サーバー・マシン上にあるデータベース・サーバー・プロセスを再始動します。
</LI></UL>
<P><H3><A NAME="HDRWQ204" HREF="auagd002.htm#ToC_179">更新サーバーの開始および停止について</A></H3>
<A NAME="IDX6316"></A>
<P>通常のセル構成では、各システム・タイプのサーバー・マシンはバイナリー配布マシンとして動作し、更新サーバー (<B>upserver</B> プロセス) のサーバー部分を実行してその <B>/usr/afs/bin</B> ディレクトリーの内容を配布します。そのシステム・タイプの他のサーバー・マシンは、バイナリー配布マシンを参照する更新サーバー・クライアント部分 (通常、<B>upclientbin</B> という) のインスタンスを実行します。
<P>米国版の AFS を稼動する場合には、最初のサーバー・マシンとしては、システム制御マシンとして動作するように設置して、更新サーバー (<B>upserver</B> プロセス) のサーバー部分がその <B>/usr/afs/etc</B> ディレクトリーの内容を配布するように動作させるのが一般的です。他のすべてのサーバー・マシンは、システム制御マシンを参照する更新サーバー・クライアント部分 (通常、<B>upclientetc</B> という) のインスタンスを実行します。
<P><TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">AFS 国際版を使用する場合は、更新サーバーを使用して <B>/usr/afs/etc</B> ディレクトリーの内容を配布しないでください(システム制御マシンを稼動しません)。この章のプロセスへのすべてのリファレンスを無視してください。
</TD></TR></TABLE>
<P>現在その役割の 1 つで使用しているマシンを使用停止しないかぎり、バイナリー配布またはシステム制御責任を別のマシンに移動しないでおくのが最も使いやすい方法です。通常、更新サーバーを実行しても、処理負荷はほとんどかかりません。機能を移動する必要がある場合には、次の関連タスクを実行します。
<UL>
<LI>システム制御マシンを置換する場合には、他のすべてのサーバー・マシン上にある <B>upclientetc</B> プロセスを停止して、新規のシステム制御マシンを参照する新しいものを定義する必要があります。
</LI><LI>バイナリー配布マシンを置換する場合には、そのシステム・タイプの他のすべてのサーバー・マシン上にある <B>upclientbin</B> プロセスを停止して、新規のバイナリー配布マシンを参照する新しいものを定義する必要があります (そのシステム・タイプのサーバー・マシンを今後稼動することがない場合)。
</LI></UL>
<HR><H2><A NAME="HDRWQ205" HREF="auagd002.htm#ToC_180">BosConfig ファイルのプロセス状況および情報の表示</A></H2>
<P>サーバー・マシン上にある AFS サーバー・プロセスの状況を表示するには、<B>bos status</B> コマンドを発行します。<B> -long</B> フラグを追加すると、そのタイプとコマンド・パラメーターを含めて <B>BosConfig</B> ファイルにある各プロセスの項目の情報のほとんどが表示されます。<B>/usr/afs</B> ディレクトリーにあるファイルとサブディレクトリーのモード・ビットが予期値と一致しない場合には、警告メッセージも表示されます。
<P><H3><A NAME="HDRWQ206" HREF="auagd002.htm#ToC_181">サーバー・プロセスの状況とその BosConfig 項目を表示する方法</A></H3>
<A NAME="IDX6317"></A>
<A NAME="IDX6318"></A>
<A NAME="IDX6319"></A>
<A NAME="IDX6320"></A>
<A NAME="IDX6321"></A>
<A NAME="IDX6322"></A>
<A NAME="IDX6323"></A>
<A NAME="IDX6324"></A>
<OL TYPE=1>
<LI><B>bos status</B> コマンドを発行します。
<P>
<PRE>   % <B>bos status</B> &lt;<VAR>machine name</VAR>>  [&lt;<VAR>server process name</VAR>><SUP>+</SUP>]  [<B>-long</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>stat
</B><DD><B>status</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD>プロセス状況を表示するファイル・サーバー・マシンを指定します。
<P><DT><B><VAR>server process name</VAR>
</B><DD>その項目が <B>bos create</B> コマンドで定義されたときに割り当てられた名前を使用して、状況を表示する各プロセスに名前を付けます。この引き数を省略すると、すべてのサーバー・プロセスの状況が表示されます。
<P><DT><B>-long
</B><DD>状況の他に、<B>BosConfig</B> ファイル内のプロセスの項目からの情報、すなわち、そのタイプ、状況フラグ、コマンド・パラメーター、関連した通知プログラム、などを表示します。
</DL>
</LI></OL>
<P>出力には各プロセスの項目が含まれ、プロセスの状況を示すために次の文字列の 1 つが使用されます。
<UL>
<LI><TT>通常、現在稼動中</TT>、プロセスが稼動していて <B>BosConfig</B> ファイル内のその状況フラグが <TT>Run</TT> になっていることを示します。cron 項目では、このメッセージはまだ稼動する予定になっていて、
<B>bos status</B> コマンドが発行されたとき必ずしも稼動していないことを示します。
</LI><LI><TT>一時的に使用可能</TT>は、プロセスは稼動しているが、<B>BosConfig</B> ファイルのその状況フラグが<TT> NotRun</TT>になっていることを示します。最も一般的な理由は、システム管理者が <B>bos startup</B> コマンドを使用してプロセスを始動したためです。
</LI><LI><TT>一時的に使用不可</TT>は、<B>BosConfig</B> ファイル内のその状況フラグが <TT>Run</TT> になっていてもプロセスが稼動していないことを示します。最も一般的な理由は、システム管理者が <B>bos shutdown</B> コマンドを使用してプロセスを停止したか、または数多くの試行が失敗した後で BOS サーバーがプロセスを再始動しようとしなかったためです。プロセスを再始動しなかった場合、補足メッセージ: <TT> エラーが多すぎるために停止しました</TT>が表示されます。
</LI><LI><TT>使用不可</TT>は、プロセスは稼動していないで、<B>BosConfig</B> ファイル内のその状況フラグが <TT>NotRun</TT>になっていることを示します。BOS サーバーは、プロセスを監視しません。フラグをこの方法で設定できるのはシステム管理者だけです。BOS サーバーが行うことはありません。
</LI></UL>
<P><B>fs</B> プロセスの出力には、常に<TT>補助状況</TT>とマークされたメッセージが含まれています。これは、以下のいずれかです。
<UL>
<LI><TT>ファイル・サーバー稼動中</TT>は、ファイル・サーバー・プロセスのファイル・サーバーとボリューム・サーバー・コンポーネントが正常に稼動していることを示します。
</LI><LI><TT>ファイル・システムのサルベージ</TT>は、サルベージャーが稼動していることを示し、通常、ファイル・サーバーとボリューム・サーバーが一時的に使用不可になっていることを意味します。それらのサーバーは、サルベージャーが完了すると、BOS サーバーによってすぐに再始動されます。
</LI></UL>
<P>cron プロセスの出力には、コマンドが次に実行する時期を報告する<TT>補助状況</TT> メッセージが含まれます。次に例を示します。
<P>任意のプロセスの出力は、どこかのポイントでプロセスが失敗して <B>/usr/afs/logs</B> ディレクトリーにコア・ファイルを生成したことを示すため、補助メッセージ「<TT>has core file</TT>」を取り入れることができます。ほとんどの場合、BOS サーバーはプロセスを再始動することができ、稼動しています。
<P>次の例には、<B>backupusers</B>と呼ばれるユーザー定義の cron 項目が含まれています。
<PRE>   % <B>bos status fs3.abc.com</B>
   Instance kaserver, currently running normally.
   Instance ptserver, currently running normally.
   Instance vlserver, has core file, currently running normally.
   Instance buserver, currently running normally.
   Instance fs, currently running normally.
       Auxiliary status is: file server running.
   Instance upserver, currently running normally.
   Instance runntp, currently running normally.
   Instance backupusers, currently running normally.
       Auxiliary status is: run next at Mon Jun 7 02:00:00 1999.
</PRE>
<P><B>bos status</B> コマンドに <B>-long</B> フラグを組み込むと、出力の各プロセスには <B>BosConfig</B> ファイルの次の追加情報が組み込まれます。
<UL>
<LI>プロセスのタイプ (<TT>simple</TT>、<TT>fs</TT>、または <TT>cron</TT>)。
</LI><LI>プロセスが最後に開始または再始動した日時。
</LI><LI><TT>proc starts</TT> の数。BOS サーバーそれ自体が開始してから、プロセスを開始または再始動した回数。
</LI><LI><TT>Last exit</TT> 時刻。プロセス (または <B>fs</B> プロセス内のコンポーネント・プロセスの 1 つ) が最後に終了した時刻。
BOS サーバーが開始してからプロセスが終了していない場合、この行は表示されません。
</LI><LI><TT>Last error exit</TT> 時刻。プロセス (または <B>fs</B> プロセス内のコンポーネント・プロセスの 1 つ) がエラーのため最後に失敗した時刻。
<TT>due to
shutdown request</TT> (終了の要求による) など、追加の説明が表示される可能性があります。BOS サーバーが開始してからプロセスに失敗がない場合、この行は表示されません。
</LI><LI>プロセスを開始するために BOS サーバーが呼び出す各コマンド。
<B>bos create</B> コマンドに対する <B>-cmd</B>
引き数で指定します。
</LI><LI>プロセスの終了時に BOS サーバーが呼び出す通知プログラムのパス名 (もしあれば)。
<B>bos create</B> コマンドに対する <B>-notifier</B>
引き数で指定します。
</LI></UL>
<P>さらに、BOS サーバーが <B>/usr/afs</B> の下の特定のファイルおよびディレクトリー上のモード・ビットが、期待から逸脱していることを発見すると、次の警告メッセージを印刷します。
<PRE>   Bosserver process reports inappropriate access on server directories
</PRE>
<P><B>/usr/afs</B> ディレクトリー以下のディレクトリーおよびファイルに対して予期される保護は次のとおりです。疑問符は、BOS サーバーがモード・ビットをチェックしないことを示します。これらのファイルおよびディレクトリーへの保護の設定についての詳細は、
<I>AFS インストールの手引き</I> を参照してください。
<BR>
<TABLE WIDTH="100%">
<TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><B>/usr/afs</B>
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><TT>drwxr</TT>?<TT>xr-x</TT>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><B>/usr/afs/backup</B>
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><TT>drwx</TT>???<TT>---</TT>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><B>/usr/afs/bin</B>
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><TT>drwxr</TT>?<TT>xr-x</TT>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><B>/usr/afs/db</B>
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><TT>drwx</TT>???<TT>---</TT>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><B>/usr/afs/etc</B>
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><TT>drwxr</TT>?<TT>xr-x</TT>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><B>/usr/afs/etc/KeyFile</B>
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><TT>-rw</TT>????<TT>---</TT>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><B>/usr/afs/etc/UserList</B>
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><TT>-rw</TT>?????<TT>--</TT>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><B>/usr/afs/local</B>
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><TT>drwx</TT>???<TT>---</TT>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><B>/usr/afs/logs</B>
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="50%"><TT>drwxr</TT>?<TT>xr-x</TT>
</TD></TR></TABLE>
<P>以下は、マシン <B>fs3.abc.com</B> 上で稼動している <B>fs</B> プロセスの拡張出力を示しています。
<PRE>   % <B>bos status fs3.abc.com fs -long</B>
   Instance fs, (type is fs), currently running normally.
       Auxiliary status is file server running
   Process last started at Mon May 3 8:29:19 1999 (3 proc starts)
   Last exit at Mon May 3 8:29:19 1999
   Last error exit at Mon May 3 8:29:19 1999, due to shutdown request
   Command 1 is '/usr/afs/bin/fileserver'
   Command 2 is '/usr/afs/bin/volserver'
   Command 3 is '/usr/afs/bin/salvager'
</PRE>
<HR><H2><A NAME="HDRWQ216" HREF="auagd002.htm#ToC_182">プロセスの作成および除去</A></H2>
<A NAME="IDX6325"></A>
<A NAME="IDX6326"></A>
<A NAME="IDX6327"></A>
<A NAME="IDX6328"></A>
<A NAME="IDX6329"></A>
<A NAME="IDX6330"></A>
<A NAME="IDX6331"></A>
<A NAME="IDX6332"></A>
<P>サーバー・マシン上で新規の AFS サーバー・プロセスを開始するには、<B>bos create</B> コマンドを発行します。<B>/usr/afs/local/BosConfig</B> ファイルに項目が作成され、ファイルおよび BOS サーバーのメモリー両方でプロセスの状況フラグが <TT>Run</TT> に設定され、直ちに稼動を開始します。そのためには、なるべく <B>/usr/afs/bin</B> ディレクトリーに新規プロセスのバイナリー・ファイルがすでにインストールされている必要があります (<A HREF="auagd008.htm#HDRWQ146">新規バイナリーのインストール</A> を参照)。
<P>プロセスを永久的に停止するには、最初に、<B>bos stop</B> コマンドを発行します。プロセスの状況フラグは、<B>BosConfig</B> ファイルと BOS サーバーのメモリー両方で <TT>NotRun</TT> に変化して、<B> bos status</B> コマンドの出力で <TT>使用不可</TT> としてマークされます。希望する場合、<B>bos delete</B> コマンドを発行してプロセスの項目を <B>BosConfig</B> ファイルから削除します。プロセスは <B>bos status</B> コマンドの出力に表示されなくなります。
<P><TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">この機能グループに説明されている方法でデータベース・サーバー・プロセスを開始または停止する場合、
<I>AFS インストールの手引き</I> のすべての指示に従って、データベース・サーバー・マシンを作成または除去してください。指定のマシンに 1 つのデータベース・サーバー・プロセスを稼働する場合、それらすべてを稼働しなくてはなりません。詳細については、
<A HREF="#HDRWQ203">データベース・サーバー・プロセスの開始および停止について</A> を参照してください。同様に、システム制御マシンまたはバイナリー配布マシン上で <B>upserver</B> プロセスを停止する場合、<A HREF="#HDRWQ204">更新サーバーの開始および停止について</A> に説明してあるように追加タスクを完了する必要があります。
</TD></TR></TABLE>
<P><H3><A NAME="HDRWQ217" HREF="auagd002.htm#ToC_183">新規プロセスを作成および開始する方法</A></H3>
<A NAME="IDX6333"></A>
<A NAME="IDX6334"></A>
<A NAME="IDX6335"></A>
<A NAME="IDX6336"></A>
<A NAME="IDX6337"></A>
<A NAME="IDX6338"></A>
<A NAME="IDX6339"></A>
<A NAME="IDX6340"></A>
<OL TYPE=1>
<LI><B>/usr/afs/etc/UserList</B> ファイルにリストされているユーザーとして認証されていることを検証します。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><B>(オプション)</B> プロセスのバイナリーがこのマシンの <B>/usr/afs/bin</B> ディレクトリーにインストールされているか検証します。必要に応じて、コンソールにログインするか、または Telnet でマシンに接続し、<B>/usr/afs/bin</B> ディレクトリーの内容をリストします。
<P>
<P>バイナリーが存在しない場合、適切なシステム・タイプのバイナリー配布マシンにインストールして、更新サーバーが、このマシンにコピーするのを待ちます。説明については、<A HREF="auagd008.htm#HDRWQ146">新規バイナリーのインストール</A> を参照してください。
<P>
<PRE>   % <B>ls /usr/afs/bin</B>
</PRE>
</LI><LI><A NAME="LIWQ218"></A><B>bos create</B> コマンドを発行して、<B>BosConfig</B> ファイルに項目を作成してプロセスを開始します。
<PRE>   % <B>bos create</B> &lt;<VAR>machine name</VAR>> &lt;<VAR>server process name</VAR>>   \
             &lt;<VAR>server type</VAR>> &lt;<VAR>command lines</VAR>><SUP>+</SUP> [ <B>-notifier</B> &lt;<VAR>Notifier program</VAR>>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>cr
</B><DD><B>create</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD>プロセスを作成するファイル・サーバー・マシンの名前を指定します。
<P><DT><B><VAR>server process name</VAR>
</B><DD>作成して開始するには、プロセスに名前を付けます。単純プロセスでは、一般的な値はプロセスのバイナリー・ファイルの名前です。最も良い方法は、プロセスを稼動するすべてのサーバー・マシンに同じ名前を使用します。以下は、単純プロセスと fs-type プロセス (標準 cron プロセスがない) の一般的な名前のリストです。
<UL>
<LI><B>buserver</B> バックアップ・サーバー用
</LI><LI><B>fs</B> ファイル・サーバー、ボリューム・サーバー、およびサルベージャーを結合するプロセス用
</LI><LI><B>kaserver</B> 認証サーバー用
</LI><LI><B>ptserver</B> 保護サーバー用
</LI><LI><B>runntp</B> ネットワーク時間プロトコル・デーモンの制御装置プロセス用
</LI><LI><B>upclientbin</B> このマシンのシステムのバイナリー配布マシンを参照する更新サーバーのクライアント部分用
</LI><LI><B>upclientetc</B> システム制御マシンを参照する更新サーバーのクライアント部分用
</LI><LI><B>vlserver</B> ボリューム・ロケーション (VL) サーバー用
</LI></UL>
<P><DT><B><VAR>サーバーのタイプ</VAR>
</B><DD>プロセスのタイプを定義します。次のいずれかの値を選択します。
<UL>
<LI><B>cron</B> cron プロセス用
</LI><LI><B>fs</B> <B>fs</B> という名前のプロセス用
</LI><LI><B>simple</B> <VAR>server process name</VAR> 引き数の許容値としてリストされた他のすべてのプロセス用
</LI></UL>
<P><DT><B><VAR>command lines</VAR>
</B><DD>このプロセスを開始するために BOS サーバーが実行する各コマンドを指定します。コマンドは 6 つまで指定できます (コマンドのオプションが含まれる場合は、文字列全体を二重引用符で囲みます)。7 番目以降のコマンドは無視されます。
<P>
<P>シンプル・プロセスでは、ローカル・ディスク上にあるそのプロセスのバイナリー・ファイルの完全パス名を指定します
(たとえば、保護サーバーの場合は <B>/usr/afs/bin/ptserver</B>)。初期設定コマンドの任意のオプションが含まれる場合は、コマンド全体を二重引用符
(<B>" "</B>) で囲みます。
<B>upclient</B> プロセスには、必須の引き数があります。その他のすべてのプロセスのコマンドでは、引き数はオプションです。
<A NAME="IDX6341"></A>
<P>
<P>
<P><B>fs</B> プロセスでは、それぞれのコンポーネント・プロセスごとに、ローカル・ディスクのバイナリー・ファイルの完全パス名を指定します。
<B>fileserver</B>、<B>volserver</B>、および <B>salvager</B> の順になります。標準のバイナリー・ディレクトリーは、<B>/usr/afs/bin</B> です。初期設定コマンドの任意のオプションが含まれる場合は、コマンド全体を二重引用符 (<B>" "</B>) で囲みます。
<A NAME="IDX6342"></A>
<P>
<P>
<P><B>cron</B> プロセスでは、次の 2 つのパラメーターを指定します。
<A NAME="IDX6343"></A>
<P>
<UL>
<LI>ローカル・ディスクにある、実行可能ファイル、または AFS スイートの 1 つであるコマンドのいずれかの完全パス名
(必要な引き数をすべて完全に指定する)。このパラメーターにスペースが含まれる場合は、パラメーターを二重引用符 (<B>" "</B>) で囲みます。
</LI><LI>BOS サーバーが、最初のパラメーターで指定されたファイルまたはコマンドの実行をいつ始めるかの指定。許容値は 3 つあります。
<UL>
<LI>文字列 <B>now</B>。
BOS サーバーは、そのファイルまたはコマンドの実行を今すぐ開始し、
1 度しか実行しません。このコマンドは、通常、直接発行するか、
<B>bos exec</B> コマンドを発行する方が簡単です。
</LI><LI>時刻。BOS サーバーは、毎日、指定された時刻に、そのファイルまたはコマンドを実行します。時間と分はコロンで区切り (<I>hh</I>:<I>MM</I>)、24 時間形式か、あるいは <B>1:00</B> から <B>12:59</B> までの値に <B>am</B> または <B>pm</B>
を付加して指定することができます。たとえば、
<B>14:30</B> と <B>"2:30 pm"</B> は、どちらも午後 2:30 を示します。このパラメーターにスペースが含まれる場合は、パラメーターを二重引用符 (<B>" "</B>) で囲みます。
</LI><LI>曜日と時刻。曜日と時刻はスペースで区切り、全体を二重引用符 (<B>" "</B>) で囲みます。
BOS サーバーは、毎週、指定された曜日の指定された時刻に、そのファイルまたはコマンドを実行します。曜日は、その曜日の名前全体かまたは最初の 3 文字を、すべて小文字で指定します
(<B>sunday</B> または <B>sun</B>、
<B>thursday</B> または <B>thu</B> など)。時刻は、時刻のみを指定する場合と同様の形式で指定します。
</LI></UL>
</LI></UL>
<P><DT><B>-notifier
</B><DD>プロセスが終了したときに BOS サーバーが実行するプログラムのパス名を指定します。通知プログラムについての詳細は、
<I>AFS Administration Reference</I> にある <B>bos create</B> コマンドの解説ページを参照してください。
</DL>
</LI></OL>
<P>次の例は、マシン <B>db2.abc.com</B> の保護サーバーを定義および開始します。
<PRE>   
   % <B>bos create db2.abc.com ptserver simple /usr/afs/bin/ptserver</B> 
   
</PRE>
<P>次の例は、マシン <B>fs6.abc.com</B> の <B>fs</B> プロセスを定義および開始します。
<PRE>   
   % <B>bos create fs6.abc.com fs fs /usr/afs/bin/fileserver </B>  \
        <B>/usr/afs/bin/volserver /usr/afs/bin/salvager</B>
    
</PRE>
<P>次の例は、マシン <B>fs3.abc.com</B> の <B>backupuser</B> プロセスという cron プロセスを定義および開始して、毎日 3:00 a.m に稼動するようにスケジュールします。
<PRE>   % <B>bos create fs3.abc.com backupuser cron
        "/usr/afs/bin/vos backupsys -prefix user -local" 3:00</B>
</PRE>
<P><H3><A NAME="Header_184" HREF="auagd002.htm#ToC_184">プロセスを停止して BosConfig ファイルから削除する</A></H3>
<A NAME="IDX6344"></A>
<A NAME="IDX6345"></A>
<A NAME="IDX6346"></A>
<A NAME="IDX6347"></A>
<A NAME="IDX6348"></A>
<A NAME="IDX6349"></A>
<A NAME="IDX6350"></A>
<OL TYPE=1>
<LI><B>/usr/afs/etc/UserList</B> ファイルにリストされているユーザーとして認証されていることを検証します。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><A NAME="LIPROC-STOP"></A><B>bos stop</B> コマンドを発行して <B>BosConfig</B> ファイルにある各プロセスの状況フラグを、<TT> NotRun</TT> に変更して、停止します。継続的に稼動しない場合でも、<B>BosConfig</B> ファイルから削除したい cron プロセスにもこのコマンドを発行する必要があります。このコマンドについての詳細は、<A HREF="#HDRWQ220">状況を NotRun に変更してプロセスを停止する方法</A> を参照してください。
<PRE>   
   % <B>bos stop</B> &lt;<VAR>machine name</VAR>> &lt;<VAR>server process name</VAR>><SUP>+</SUP> [<B>-wait</B>]
   
</PRE>
</LI><LI><A NAME="LIPROC-DEL"></A><B>bos delete</B> コマンドを発行して、各プロセスを <B>BosConfig</B> ファイルから削除します。
<P>
<PRE>   % <B>bos delete</B> &lt;<VAR>machine name</VAR>> &lt;<VAR>server process name</VAR>><SUP>+</SUP>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>d
</B><DD><B>delete</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD><B>BosConfig</B> ファイルからプロセスを削除するサーバー・マシンを指定します。
<P><DT><B><VAR>server process name</VAR>
</B><DD><B>BosConfig</B> ファイルから削除する各プロセス項目に名前を付けます。<A HREF="#LIPROC-STOP">2</A> のステップで指定したのと同じ名前を指定します。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ219" HREF="auagd002.htm#ToC_185">プロセスを永続的に停止および開始する</A></H2>
<A NAME="IDX6351"></A>
<A NAME="IDX6352"></A>
<A NAME="IDX6353"></A>
<A NAME="IDX6354"></A>
<P>BOS サーバーが監視しないようにするためプロセスを停止するには、<B>bos stop</B> コマンドを発行します。プロセスの状況フラグは、BOS サーバーのメモリーおよび <B>BosConfig</B> ファイル両方で <TT>NotRun</TT> に設定されます。<B>bos start</B> コマンドを発行するまでプロセスは再稼動しません。素の状況フラグは、BOS サーバーのメモリーおよび <B> BosConfig</B> ファイル両方で <TT>Run</TT> に戻されます。(<B>bos startup</B> コマンドを使用すると、<B>BosConfig</B> ファイルの状況フラグを変更しなくてもプロセスを再始動することができます。<A HREF="#HDRWQ222">プロセスを一時的に停止および開始する</A> を参照してください。)
<P><B>BosConfig</B> ファイルには BOS サーバー用の項目はないので、<B>bos stop</B> および <B>bos start</B> コマンドは BOS サーバーを制御しません。他のすべてのプロセスとともに BOS サーバーを停止して直ちに再始動するには、<A HREF="#HDRWQ225">プロセスの停止および即時の再始動</A> に説明してあるように、<B>bos restart</B> コマンドに <B>-bosserver</B> フラグを使用します。
<P><TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">この機能グループに説明されている方法でデータベース・サーバー・プロセスを開始または停止する場合、
<I>AFS インストールの手引き</I> のすべての指示に従って、データベース・サーバー・マシンを作成または除去してください。指定のマシンに 1 つのデータベース・サーバー・プロセスを稼働する場合、それらすべてを稼働しなくてはなりません。詳細については、
<A HREF="#HDRWQ203">データベース・サーバー・プロセスの開始および停止について</A> を参照してください。同様に、システム制御マシンまたはバイナリー配布マシン上で <B>upserver</B> プロセスを停止する場合、<A HREF="#HDRWQ204">更新サーバーの開始および停止について</A> に説明してあるように追加タスクを完了する必要があります。
</TD></TR></TABLE>
<P><H3><A NAME="HDRWQ220" HREF="auagd002.htm#ToC_186">状況を NotRun に変更してプロセスを停止する方法</A></H3>
<A NAME="IDX6355"></A>
<A NAME="IDX6356"></A>
<A NAME="IDX6357"></A>
<A NAME="IDX6358"></A>
<A NAME="IDX6359"></A>
<A NAME="IDX6360"></A>
<OL TYPE=1>
<LI><B> /usr/afs/etc/UserList</B> ファイルにリストされているユーザーとして認証されていることを検証します。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><B>bos stop</B> コマンドを発行して各プロセスを停止し、<B>BosConfig</B> ファイルおよび BOS サーバーのメモリーでその状況フラグを <TT>NotRun</TT> に設定します。
<PRE>   % <B>bos stop</B> &lt;<VAR>machine name</VAR>> &lt;<VAR>server process name</VAR>><SUP>+</SUP> [<B>-wait</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>sto
</B><DD><B>stop</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD>プロセスを停止するサーバー・マシンを指定します。
<P><DT><B><VAR>server process name</VAR>
</B><DD>その項目が <B>bos create</B> コマンドで定義されたときに割り当てられた名前を使用して、停止する各プロセスに名前を付けます。
<P><DT><B>-wait
</B><DD>すべての指定したプロセスが停止するまで、コマンド・シェル・プロンプトの戻りを遅らせます。このフラグを省略すると、すべてのプロセスがまだ停止していなくても、プロンプトがほぼ即時に戻ります。
</DL>
</LI></OL>
<P><H3><A NAME="HDRWQ221" HREF="auagd002.htm#ToC_187">状況フラグを Run に変更してプロセスを開始する方法</A></H3>
<A NAME="IDX6361"></A>
<A NAME="IDX6362"></A>
<A NAME="IDX6363"></A>
<A NAME="IDX6364"></A>
<A NAME="IDX6365"></A>
<OL TYPE=1>
<LI>ユーザーが、<B>/usr/afs/etc/UserList</B> ファイルにリストされているかどうかを検証する。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><A NAME="LIPROC-START"></A><B>bos start</B> コマンドを発行して、<B> BosConfig</B> ファイルと BOS サーバーのメモリー両方で各プロセスの状況フラグを <TT>Run</TT> に変更して、開始します。
<PRE>   %  <B>bos start</B> &lt;<VAR>machine name</VAR>> &lt;<VAR>server process name</VAR>><SUP>+</SUP>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>start
</B><DD>完全な形式で入力する必要があります。
<P><DT><B><VAR>machine name</VAR>
</B><DD>各プロセスの実行を開始するサーバー・マシンを指定します。
<P><DT><B><VAR>server process name</VAR>
</B><DD><VAR>machine name</VAR> で開始する各プロセスを指定します。作成時にプロセスに割り当てられた名前を使用します。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ222" HREF="auagd002.htm#ToC_188">プロセスを一時的に停止および開始する</A></H2>
<P>ときには、プロセスを一時的に停止することが必要になります (たとえば、構成をわずかに変更する、または保守を実行するような場合)。この節で説明するコマンドは、BOS サーバーのメモリーのみにあるプロセスの状況を変更します。変更による影響は即時に現れ、メモリー状態を再び変更するまで継続します (または、BOS サーバーが再始動するまで継続し、再始動したときには、<B>BosConfig</B> ファイル内の項目に従ってプロセスが開始します)。
<P>BOS サーバー・メモリーの状況フラグを <TT>NotRun</TT> に変更してプロセスを一時的に停止するには、<B>bos shutdown</B> コマンドを使用します。BOS サーバーのメモリーにある状況フラグを <TT>Run</TT> に変更して、停止したプロセスを再始動するには、<B>bos startup</B> コマンドを使用します。プロセスは、<B> BosConfig</B> ファイル内の状況フラグに関係なく開始します。以下で説明するように、<B>bos startup</B> コマンドを使用しても、<B>BosConfig</B> ファイル <TT>Run</TT> でマークされたすべてのプロセスを開始することができます。
<P><B>bos startup</B> コマンドは、<B>BosConfig</B> ファイルの状況フラグを変更しないでプロセスを開始するため、永久的に使用可能にしないでサーバー・プロセスをテストするときには便利です。<B>BosConfig</B> ファイルの状況フラグを変更して、プロセスを停止および開始するには、<A HREF="#HDRWQ219">プロセスを永続的に停止および開始する</A> を参照してください。プロセスを停止および即時に再始動する方法については、<A HREF="#HDRWQ225">プロセスの停止および即時の再始動</A> を参照してください。
<TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">すべてのマシンのデータベース・サーバー・プロセスを同時に一時停止させないでください。そうすることによって、すべてのデータベースが完全に使用不可になります。
</TD></TR></TABLE>
<A NAME="IDX6366"></A>
<A NAME="IDX6367"></A>
<P><H3><A NAME="HDRWQ223" HREF="auagd002.htm#ToC_189">プロセスを一時停止させる方法</A></H3>
<OL TYPE=1>
<LI>ユーザーが、<B>/usr/afs/etc/UserList</B> ファイルにリストされているかどうかを検証する。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><A NAME="LIWQ224"></A>BOS サーバーのメモリーの状況フラグを <TT>NotRun</TT> に変更して各プロセスを停止するには、<B>bos shutdown</B> コマンドを発行します。
<PRE>   % <B>bos shutdown</B> &lt;<VAR>machine name</VAR>> [&lt;<VAR>instances</VAR>><SUP>+</SUP>] [<B>-wait</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>sh
</B><DD><B>shutdown</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD>プロセスを一時的に停止するサーバー・マシンを指定します。
<P><DT><B><VAR>instances</VAR>
</B><DD>一時停止させる各プロセスを指定します。作成時にプロセスに割り当てられた名前を使用します。
<P><DT><B>-wait
</B><DD>すべての指定したプロセスが実際に停止するまで、コマンド・シェル・プロンプトの戻りを遅らせます。このフラグを省略すると、すべてのプロセスがまだ停止していなくても、プロンプトがほぼ即時に戻ります。
</DL>
</LI></OL>
<A NAME="IDX6368"></A>
<A NAME="IDX6369"></A>
<P><H3><A NAME="Header_190" HREF="auagd002.htm#ToC_190">BosConfig ファイルの状況フラグが Run になっているすべての停止されたプロセスを開始する方法</A></H3>
<OL TYPE=1>
<LI>ユーザーが、<B>/usr/afs/etc/UserList</B> ファイルにリストされているかどうかを検証する。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><B>bos startup</B> コマンドを発行し、BOS サーバーのメモリーの状況フラグを <TT>NotRun</TT> から <TT>Run</TT> に変更して、<B> BosConfig</B> ファイルで状況フラグ <TT>Run</TT> のあるマシンで各プロセスを開始します。
<PRE>   % <B>bos startup</B> &lt;<VAR>machine name</VAR>>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>startup
</B><DD>完全な形式で入力する必要があります。
<P><DT><B><VAR>machine name</VAR>
</B><DD><B>BosConfig</B> ファイルの状況フラグが <TT>Run</TT> になっているすべてのプロセスを開始するサーバー・マシンを指定します。
</DL>
</LI></OL>
<P><H3><A NAME="Header_191" HREF="auagd002.htm#ToC_191">特定のプロセスを開始する方法</A></H3>
<OL TYPE=1>
<LI>ユーザーが、<B>/usr/afs/etc/UserList</B> ファイルにリストされているかどうかを検証する。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><B>BosConfig</B> ファイルの状況フラグを変更しないで、BOS サーバーのメモリーにある状況フラグを <TT> Run</TT> に変更し、<B>bos startup</B> コマンドを発行して特定プロセスを開始します。
<PRE>   % <B>bos startup</B> &lt;<VAR>machine name</VAR>> &lt;<VAR>instances</VAR>><SUP>+</SUP>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>startup
</B><DD>完全な形式で入力する必要があります。
<P><DT><B><VAR>machine name</VAR>
</B><DD>プロセスを開始するサーバー・マシンに名前を付けます。
<P><DT><B><VAR>instances</VAR>
</B><DD>開始する各プロセスを指定します。作成時にプロセスに割り当てられた名前を使用します。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ225" HREF="auagd002.htm#ToC_192">プロセスの停止および即時の再始動</A></H2>
<A NAME="IDX6370"></A>
<A NAME="IDX6371"></A>
<P>デフォルトでは、BOS サーバーは、新しくインストールされたバイナリー・ファイルを毎日チェックして関連するプロセスを再始動しますが、プロセスを停止して即時に再始動したいときもあります。<B>bos restart</B> コマンドにはこの機能があり、影響のある各プロセスの完全に新しいインスタンスを開始します。
<UL>
<LI>BOS サーバーを停止して再始動させ、<B>BosConfig</B> ファイルにある <TT>Run</TT> 状況フラグでマークされたすべてのプロセスを再始動するには、<B>-bosserver</B> フラグを組み込みます。
</LI><LI><B>BosConfig</B> ファイルにある <TT>Run</TT> 状況フラグでマークされたすべてのプロセスを停止して再始動するには、<B> -all</B> フラグを組み込みます。BOS サーバーは再始動しません。
</LI><LI><B>BosConfig</B> 内での状況フラグの設定に関係なく、特定のプロセスを停止して再始動するには、再始動する各プロセスの名前を指定します。
</LI></UL>
<P>プロセスを再始動すると、サービスの障害が起こります。通常は、使用率が低い時間帯に再始動をスケジュールするのが最適です。長時間にわたってプロセスを稼働すると拡大する可能性があるコア・リークの可能性を減らすために、
BOS サーバーは、すべてのプロセスを週に 1 度、自動的に再始動します。
<A HREF="#HDRWQ226">BOS サーバーの再始動時を設定する</A> を参照してください。
<A NAME="IDX6372"></A>
<A NAME="IDX6373"></A>
<P>
<A NAME="IDX6374"></A>
<A NAME="IDX6375"></A>
<A NAME="IDX6376"></A>
<A NAME="IDX6377"></A>
<A NAME="IDX6378"></A>
<P><H3><A NAME="Header_193" HREF="auagd002.htm#ToC_193">BOS サーバーを含むすべてのプロセスを停止して再始動する方法</A></H3>
<OL TYPE=1>
<LI>ユーザーが、<B>/usr/afs/etc/UserList</B> ファイルにリストされているかどうかを検証する。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><B> -bosserver</B> フラグを付けて <B>bos restart</B> コマンドを発行して、BOS サーバーを停止して再始動します。<B>BosConfig</B> ファイル内にある状況フラグ <TT>Run</TT> でマークされたすべてのプロセスが再始動します。
<PRE>   % <B>bos restart</B> &lt;<VAR>machine name</VAR>>  <B>-bosserver</B>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>res
</B><DD><B>restart</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD>すべてのプロセスを再始動させるサーバー・マシンを指定します。
<P><DT><B>-bosserver
</B><DD>そのマシン上で稼働している BOS サーバーおよびすべてのプロセスを停止させます。新規の BOS サーバー・インスタンスが開始します。次に、<B>BosConfig</B> ファイルに状況 <TT>Run</TT> がマークされたすべてのプロセスの新規のインスタンスを開始します。
</DL>
</LI></OL>
<A NAME="IDX6379"></A>
<A NAME="IDX6380"></A>
<A NAME="IDX6381"></A>
<A NAME="IDX6382"></A>
<P><H3><A NAME="Header_194" HREF="auagd002.htm#ToC_194">BOS サーバーを除くすべてのプロセスを停止して即時に再始動する</A></H3>
<OL TYPE=1>
<LI>ユーザーが、<B>/usr/afs/etc/UserList</B> ファイルにリストされているかどうかを検証する。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><B>bos restart</B> コマンドに <B> -all</B> フラグを付けて発行し、<B>BosConfig</B> ファイルの状況フラグ <TT>Run</TT> でマークされたすべてのプロセスを停止し、即時に再始動します。
BOS サーバーは再始動しません。
<P>
<PRE>   % <B>bos restart</B> &lt;<VAR>machine name</VAR>> <B>-all</B>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>res
</B><DD><B>restart</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD>プロセスを停止、再始動するサーバー・マシンを指定します。
<P><DT><B>-all
</B><DD><B>BosConfig</B> ファイルにある状況フラグ <TT> Run</TT> でマークされたすべてのプロセスを停止して即時に再始動します。
</DL>
</LI></OL>
<A NAME="IDX6383"></A>
<A NAME="IDX6384"></A>
<A NAME="IDX6385"></A>
<A NAME="IDX6386"></A>
<P><H3><A NAME="Header_195" HREF="auagd002.htm#ToC_195">特定のプロセスを停止して即時に再始動する方法</A></H3>
<OL TYPE=1>
<LI>ユーザーが、<B>/usr/afs/etc/UserList</B> ファイルにリストされているかどうかを検証する。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><B>bos restart</B> コマンドを発行し、
<B>BosConfig</B> ファイルの状況フラグの設定に関係なく、指定した 1 つまたは複数のプロセスを停止し、即時に再始動します。
<P>
<PRE>   % <B>bos restart</B> &lt;<VAR>machine name</VAR>> &lt;<VAR>instances</VAR>><SUP>+</SUP>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>res
</B><DD><B>restart</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD>指定されたプロセスを再始動するサーバー・マシンの名前を指定します。
<P><DT><B><VAR>instances</VAR>
</B><DD>停止して、即時に再始動する各プロセスを指定します。作成時にプロセスに割り当てられた名前を使用します。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ226" HREF="auagd002.htm#ToC_196">BOS サーバーの再始動時を設定する</A></H2>
<A NAME="IDX6387"></A>
<A NAME="IDX6388"></A>
<A NAME="IDX6389"></A>
<A NAME="IDX6390"></A>
<A NAME="IDX6391"></A>
<A NAME="IDX6392"></A>
<A NAME="IDX6393"></A>
<A NAME="IDX6394"></A>
<A NAME="IDX6395"></A>
<P>デフォルトでは、BOS サーバーは週に 1 回再始動して、新規インスタンスはローカルの <B> /usr/afs/local/BosConfig</B> ファイルにある状況フラグ <TT>Run</TT> でマークされたすべてのプロセスを再始動します (<B>-bosserver</B> フラグを付けて <B>bos restart</B> コマンドを発行するのと同じです)。デフォルトの再始動時間は日曜日の午前 4 時です。週ごとの再始動は、<I>コア・リーク</I> が最も少なくなるように設計されているので、プロセスが仮想メモリーを継続して割り当てるときに拡大しますが、再び開放することはありません。メモリーを完全に使い果たすと、マシンが正しく機能しなくなります。
<P>デフォルトでは、BOS サーバーは新規にインストールされたバイナリー・ファイルを 1 日 1 回検査します。<B>/usr/afs/bin</B> ディレクトリーにあるプロセスのバイナリー・ファイルの変更タイム・スタンプがプロセスを最後に始動した時刻よりも新しいことが分かると、プロセスは、新しいインスタンスが新規バイナリー・ファイルを使い始められるように再始動します。デフォルトのバイナリー検査時刻は、午前 5 時です。
<P>ファイル・システムがアクセス不能なあいだ、再始動によって障害が起こる可能性があるため、再始動のデフォルト時は、使用頻度が最も少ないと思われる早朝です。任意のデータベース・サーバー・マシン上でデータベース・サーバー・プロセスを再始動すると、システム全体が一時的にすべてのユーザーに使用不可になります。その場合、他のタイプのプロセスを再始動すると、そのマシンのプロセスと対話しているユーザーだけが不便を感じることになります。一般的に、最長停止は、ファイル・サーバーがすべてのボリュームを再アタッチする必要があるため、<B>fs</B> プロセスを再始動したことにより発生します。
<A NAME="IDX6396"></A>
<A NAME="IDX6397"></A>
<A NAME="IDX6398"></A>
<P>各ファイル・サーバー・マシンの <B>BosConfig</B> ファイルは、2 度の再始動時を記録します。現在の設定を表示するには、<B>bos getrestart</B> コマンドを発行します。時刻をリセットするには、<B>bos setrestart</B> コマンドを使用します。
<A NAME="IDX6399"></A>
<A NAME="IDX6400"></A>
<A NAME="IDX6401"></A>
<P><H3><A NAME="Header_197" HREF="auagd002.htm#ToC_197">BOS サーバー再始動時を表示する方法</A></H3>
<OL TYPE=1>
<LI><B>bos getrestart</B> コマンドを発行して自動再始動時を表示します。
<P>
<PRE>   % <B>bos getrestart</B> &lt;<VAR>machine name</VAR>>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>getr
</B><DD><B>getrestart</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD>再始動時を表示するサーバー・マシンを指定します。
</DL>
</LI></OL>
<A NAME="IDX6402"></A>
<A NAME="IDX6403"></A>
<A NAME="IDX6404"></A>
<P><H3><A NAME="HDRWQ227" HREF="auagd002.htm#ToC_198">一般再始動時またはバイナリー再始動時を設定する方法</A></H3>
<OL TYPE=1>
<LI>ユーザーが、<B>/usr/afs/etc/UserList</B> ファイルにリストされているかどうかを検証する。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><B> -general</B> フラグを付けて <B>bos setrestart</B> コマンドを発行して、一般的な再始動時を設定するかまたは <B>-newbinary</B> フラグを付けてバイナリー再始動時を設定します。コマンドは、1 回にフラグの 1 つだけを受け入れます。
<P>
<PRE>   % <B>bos setrestart</B> &lt;<VAR>machine name</VAR>> "&lt;<VAR>time to restart server</VAR>>"
                    [<B>-general</B>]  [<B>-newbinary</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>setr
</B><DD><B>setrestart</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD>サーバー・マシンを指定します。
<P><DT><B><VAR>time to restart server</VAR>
</B><DD>BOS サーバーが自ら再始動するときを設定するか (<B> -general</B> フラグと結合した場合)、または新規バイナリー・ファイルによりどれかのプロセスを設定します (<B>-newbinary</B> フラグと結合した場合)。以下の値のいずれかを指定します。
<UL>
<LI>文字列 <B>never</B>。指示されたタイプの再始動を実行しないように BOS サーバーに指示します。
</LI><LI>時刻 (バイナリー開始時の一般的なタイプの値)。時間と分をコロンで分離して (<I>hh</I>:<I>MM</I>)、24 時間形式を使用するか、または <B>am</B> または <B>pm</B> を追加して <B>1:00</B> から <B>12:59</B> までの範囲の値を使用します。たとえば、<B>14:30</B> と <B>"2:30 pm"</B> は両方とも午後 2 時半を示します。スペースが含まれる場合には、このパラメーターを二重引用符 (<B>" "</B>) で囲います。
</LI><LI>曜日と時刻。スペースで分離して二重引用符 (<B>" "</B>) で囲います。一般的な再始動の値を示すための標準的なタイプです。曜日には、名前全体または最初の 3 文字を使用し、すべてを小文字で表示します (<B>sunday</B> または <B>sun</B>, <B>thursday</B> または <B>thu</B>など)。時刻では、時刻だけを指定するときと同じ形式を使用します。
</LI></UL>
<P>
<P>
<P>希望する場合、時刻または日と時刻定義の前に、文字列 <B>every</B> または <B>at</B> を使用します。これらのワードを使っても意味は変化しませんが、<B>bos getrestart</B> コマンドの出力が理解しやすくなります。
<P>
<TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">指定した時刻が現在の時刻の 1 時間以内の場合には、BOS サーバーは、次の適切な時刻まで再始動を実行しません (時刻の場合には翌日または日と時刻の場合には翌週)。
</TD></TR></TABLE>
<P><DT><B>-general
</B><DD>BOS サーバーが自ら再始動するときの一般的な再始動時を設定します。
<P><DT><B>-newbinary
</B><DD>新規バイナリー・ファイルによるプロセスの再始動時を設定します。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ228" HREF="auagd002.htm#ToC_199">サーバー・プロセス・ログ・ファイル表示する</A></H2>
<A NAME="IDX6405"></A>
<A NAME="IDX6406"></A>
<A NAME="IDX6407"></A>
<A NAME="IDX6408"></A>
<A NAME="IDX6409"></A>
<A NAME="IDX6410"></A>
<A NAME="IDX6411"></A>
<A NAME="IDX6412"></A>
<A NAME="IDX6413"></A>
<A NAME="IDX6414"></A>
<A NAME="IDX6415"></A>
<A NAME="IDX6416"></A>
<A NAME="IDX6417"></A>
<A NAME="IDX6418"></A>
<A NAME="IDX6419"></A>
<A NAME="IDX6420"></A>
<A NAME="IDX6421"></A>
<A NAME="IDX6422"></A>
<P>各ファイル・サーバー・マシンの <B>/usr/afs/logs</B> ディレクトリーは、いくつかの AFS サーバー・プロセスの通常のオペレーションの際に起こる興味深い事象について説明するログ・ファイルを含みます。ログ・ファイルの自明の情報は、プロセスの障害、およびその他の問題を評価するのに役立ちます。ログ・ファイルをリモートで表示するには、<B>bos getlog</B> コマンドを使用します。サーバー・マシンに接続を確立して、テキスト・エディターまたはその他のファイル表示プログラム (たとえば、<B>cat</B> コマンド) を使用することもできます。
<TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">データベース・サーバー・プロセスを定期的に終了して再始動しない場合は、ログ・ファイルが、管理できなくなるほど大きくなる可能性があります (たとえば、一般再始動時を使用不可にする場合)。この場合には、UNIX <B>rm</B> コマンドを定期的に発行して現在のログ・ファイルを削除するようにします。サーバー・プロセスは、必要に応じて新しいものを自動的に作成します。
</TD></TR></TABLE>
<A NAME="IDX6423"></A>
<A NAME="IDX6424"></A>
<P><H3><A NAME="Header_200" HREF="auagd002.htm#ToC_200">サーバー・プロセス・ログ・ファイルを検査する方法</A></H3>
<OL TYPE=1>
<LI>ユーザーが、<B>/usr/afs/etc/UserList</B> ファイルにリストされているかどうかを検証する。必要な場合には、<B>bos listusers</B> コマンドを発行します。このコマンドについては、<A HREF="auagd021.htm#HDRWQ816">UserList ファイルのユーザーの表示</A>で詳しく説明しています。
<P>
<PRE>   % <B>bos listusers</B> &lt;<VAR>machine name</VAR>>
</PRE>
</LI><LI><B>bos getlog</B> コマンドを発行してログ・ファイルを表示します。
<PRE>   % <B>bos getlog</B>  &lt;<VAR>machine name</VAR>>  &lt;<VAR>log file to examine</VAR>>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>getl
</B><DD><B>getlog</B> の受け入れ可能な最も短い省略形です。
<P><DT><B><VAR>machine name</VAR>
</B><DD>ログ・ファイルを表示するサーバー・マシンを指定します。
<P><DT><B><VAR>log file to examine</VAR>
</B><DD>表示するログ・ファイルの名前を指定します。次のファイル名の 1 つを設定して、指示されたログ・ファイルを <B>/usr/afs/logs</B> ディレクトリーから表示します。
<UL>
<LI><B>AuthLog</B> 認証サーバー・ログ・ファイル用
</LI><LI><B>BackupLog</B> バックアップ・サーバー・ログ・ファイル
</LI><LI><B>BosLog</B> BOS サーバー・ログ・ファイル用
</LI><LI><B>FileLog</B> ファイル・サーバー・ログ・ファイル用
</LI><LI><B>SalvageLog</B>サルベージャー・ログ・ファイル用
</LI><LI><B>VLLog</B> ボリューム・ロケーション (VL) サーバー・ログ・ファイル用
</LI><LI><B>VolserLog</B> ボリューム・サーバー・ログ・ファイル用
</LI></UL>
<P>
<P>
<P>完全パス名または相対パス名を指定すると、別のディレクトリーからファイルを表示することができます。相対パス名は、
<B>/usr/afs/logs</B> ディレクトリーの相対パスと解釈されます。
</DL>
</LI></OL>
<P><HR><B>&#91; <A HREF="#Top_Of_Page">ページのトップ</A> &#124; <A HREF="auagd008.htm">前ページ</A> &#124; <A HREF="auagd010.htm">次ページ</A> &#124; <A HREF="auagd002.htm#ToC">目次</A> &#124; <A HREF="auagd026.htm#HDRINDEX">索引</A> &#93;</B> 
<!-- Begin Footer Records  ========================================== -->
<P><HR><B> 
<br>(C) <A HREF="http://www.ibm.com/">IBM Corporation 2000.</A>  All Rights Reserved<!-- 991224 --> 
</B> 
<!-- End Footer Records  ============================================ -->
<A NAME="Bot_Of_Page"></A>
</BODY></HTML>
