<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3//EN">
<HTML><HEAD>
<TITLE>管理解説書</TITLE>
<!-- Begin Header Records  ========================================== -->
<!-- C:\IDWB\TEMP\idwt1068\AUARF000.SCR converted by idb2h R4.2 (359) -->
<!-- ID Workbench Version (OS2) on 24 Dec 1999 at 21:46:04            -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Shift_JIS">
<META HTTP-EQUIV="updated" CONTENT="Fri, 24 Dec 1999 21:46:02">
<META HTTP-EQUIV="review" CONTENT="Sun, 24 Dec 2000 21:46:02">
<META HTTP-EQUIV="expires" CONTENT="Mon, 24 Dec 2001 21:46:02">
</HEAD><BODY>
<!-- (C) IBM Corporation 2000. All Rights Reserved    --> 
<BODY bgcolor="ffffff"> 
<!-- End Header Records  ============================================ -->
<A NAME="Top_Of_Page"></A>
<H1>管理解説書</H1>
<P>
<H2><A NAME="HDRBK_READLABEL" HREF="auarf002.htm#ToC_98">backup readlabel</A></H2>
<A NAME="IDX4386"></A>
<A NAME="IDX4387"></A>
<A NAME="IDX4388"></A>
<A NAME="IDX4389"></A>
<A NAME="IDX4390"></A>
<A NAME="IDX4391"></A>
<A NAME="IDX4392"></A>
<A NAME="IDX4393"></A>
<P><STRONG>目的</STRONG>
<P>磁気テープのラベルを読み取り、表示します。
<P><STRONG>構文</STRONG>
<PRE><B>backup readlabel</B>  [<B>-portoffset</B> &lt;<VAR>TC port offset</VAR>>]
                  [<B>-localauth</B>]  [<B>-cell</B> &lt;<VAR>cell name</VAR>>]  [<B>-help</B>]
   
<B>backup rea</B> [<B>-p</B> &lt;<VAR>TC port offset</VAR>>]  [<B>-l</B>]  [<B>-c</B> &lt;<VAR>cell name</VAR>>]  [<B>-h</B>]
</PRE>
<P><STRONG>構文</STRONG>
<P><B>backup readlabel</B> コマンドは、磁気テープの磁気テープ・ラベルの情報を表示します。磁気テープの名前 (<I>永続名</I>、または磁気テープの内容を表す <I>AFS 磁気テープ名</I> が特定の形式で書き込まれます) とその容量などを表示します。
<P>指定されたポート・オフセットの <B>/usr/afs/backup/CFG_</B><VAR>device_name</VAR> ファイルに <B>FILE YES</B> 命令がある場合、
<B>backup readlabel</B> コマンドは、磁気テープの先頭ではなく、テープ・コーディネーターの <B>/usr/afs/backup/tapeconfig</B> ファイルのポート・オフセットにリストされているバックアップ・データ・ファイルの最初の 16 KB からラベル情報を読み取ります。
<P>このコマンドを実行すると、デフォルトでは、テープ・コーディネーターは、ローカルの <B>/usr/afs/backup/CFG_</B><VAR>device_name</VAR> ファイルの <B>MOUNT</B> 命令を呼び出して、最初の磁気テープにアクセスします。<B>MOUNT</B> 命令がない場合には、磁気テープの挿入をバックアップ操作員に要求します。ただし、<B> CFG_</B><VAR>device_name</VAR> ファイルに <B>AUTOQUERY NO</B> 命令があるか、あるいは <B>butc</B> コマンドが <B>-noautoquery</B> フラグ付きで発行されている場合には、テープ・コーディネーターは、磁気テープがすでに装置に挿入されているとみなします。そうでない場合、テープ・コーディネーターは <B>MOUNT</B> 命令を呼び出すか、操作員にプロンプトを出します。
<P><STRONG>オプション </STRONG>
<DL>
<P><DT><B>-portoffset
</B><DD>この操作で磁気テープを処理するテープ・コーディネーターのポート・オフセット番号を指定します。
<P><DT><B>-localauth
</B><DD>ローカルの <B>/usr/afs/etc/KeyFile</B> ファイルのキーを使用して、サーバー・チケットを構成します。相互認証の間、
<B>backup</B> コマンド・インタープリターは、バックアップ・サーバー、ボリューム・サーバーおよび VL サーバーにこのチケットを提供します。このフラグは、<B>-cell</B> 引き数と一緒に使用してはなりません。詳細については、<B>backup</B> の解説ページを参照してください。
<P><DT><B>-cell
</B><DD>コマンドを実行するセルを指定します。この引き数は、
<B>-localauth</B> フラグと一緒に使用してはなりません。詳細については、<B>backup</B> の解説ページを参照してください。
<P><DT><B>-help
</B><DD>このコマンドのオンライン・ヘルプを出力します。これ以外の有効なオプションはすべて無視されます。
</DL>
<P><STRONG>出力</STRONG>
<P>このコマンドの出力は、コマンドが発行されたシェル・ウィンドウと [テープ・コーディネーター] ウィンドウに表示されます。
<P>磁気テープにラベルが付いていないか、指定された磁気テープ装置が空の場合には、次のような出力が表示されます。
<PRE>   Failed to read tape label.
   
</PRE>
<P>そうでない場合には、シェル・ウィンドウに次の出力が表示されます。
<PRE>   Tape read was labelled: <VAR>tape name</VAR> (<VAR>dump id</VAR>)
        size: <VAR>size</VAR> Kbytes
    
</PRE>
<P>磁気テープに永続名がある場合には <VAR>tape name</VAR> に永続名が、そうでない場合には AFS 磁気テープ名が表示されます。
<VAR>dump ID</VAR> には、磁気テープにある初期ダンプのダンプ ID が、
<VAR>size</VAR> には記録されている磁気テープの容量が キロバイトで表示されます。
<P>[テープ・コーディネーター] ウィンドウでは、下線で囲まれた <TT>Tape</TT> <TT>label</TT> という見出しが上部に表示され、下部には次の文字列が表示されます。
<PRE>   -- End of tape label --
   
</PRE>
<P>この間に、次の情報が表示されます。
<DL>
<P><DT><B><TT>tape name</TT>
</B><DD><B>backup labeltape</B> コマンドの
<B>-pname</B> 引き数で割り当てられた永続名。この名前はこの引き数が再度使用されるまで磁気テープに残ります。磁気テープが再利用された回数やラベルの変更回数には関係ありません。磁気テープに永続名がない場合には、このフィールドに <TT>&lt;NULL></TT> が表示されます。
<P><DT><B><TT>AFS tape name</TT>
</B><DD>磁気テープ名。次のいずれかの形式で表示されます。バックアップ・システムは、
<B>backup dump</B> または <B>backup savedb</B> 操作の一部として、該当する AFS 磁気テープ名をラベルに自動的に書き込みます。この名前は、<B>-name</B> 引き数を付けて <B>backup labeltape</B> コマンドを発行しても割り当てることができます。
<UL>
<LI>磁気テープにボリューム・データがある場合には、
<VAR>volume_set_name</VAR><B>.</B><VAR>dump_level_name</VAR><B>.</B><VAR>tape_index</VAR>。
<VAR>volume_set_name</VAR> は、初期ダンプを作成するときにこの磁気テープのダンプ・セットにダンプされたボリューム・セットの名前です。
<VAR>dump_level_name</VAR> は、初期ダンプがバックアップされたダンプ・レベルの最後のパス名の要素です。
<VAR>tape_index</VAR> は、ダンプ・セット内での磁気テープの位置を数値で表しています。
</LI><LI><B> backup savedb</B> コマンドで作成されたバックアップ・データベースのダンプが磁気テープにある場合には、
<TT>Ubik.db.dump.</TT><VAR>tape_index</VAR>> という形式で表示されます。
<VAR>tape_index</VAR> は、ダンプ・セット内での磁気テープの位置です。
</LI><LI>磁気テープに AFS 磁気テープ名がない場合には、
<TT>&lt;NULL></TT> が表示されます。最後に <B>-name</B> 引き数なしで <B>backup labeltape</B> コマンドがこの磁気テープに使用されてからデータが更新されていなければ、これは正常です。
</LI></UL>
<P><DT><B><TT>creationTime</TT>
</B><DD>バックアップ・システムがダンプ操作を開始し、初期ダンプを作成した時刻。
<P><DT><B><TT>cell</TT>
</B><DD>ダンプ・セットが作成されたセル。このセルのバックアップ・データベースに、ダンプ・セットのレコードが格納されています。
<P><DT><B><TT>size</TT>
</B><DD>ラベルに記録された磁気テープの容量。
KB 単位で表示されます。これは、磁気テープ上のデータ量ではありません。この値は、<B>backup labeltape</B> コマンドの <B>-size</B> 引き数で割り当てられた値か、テープ・コーディネーター・マシンにある <B>/usr/afs/backup/tapeconfig</B> ファイルに指定されている値です。磁気テープを実際に測定した値ではありません。
<P><DT><B><TT>dump path</TT>
</B><DD>ダンプ・セットにある初期ダンプのダンプ・レベル。
<P><DT><B><TT>dump id</TT>
</B><DD>ダンプ・セットにある初期ダンプのダンプ ID 番号。バックアップ・データベースに記録されています。
<P><DT><B><TT>useCount</TT>
</B><DD>磁気テープにダンプが書き込まれた回数。または、磁気テープのラベルが変更された回数。
</DL>
<P>出力が完了すると、<TT>ReadLabel: 完了</TT> というメッセージが表示されます。
<P><STRONG>例</STRONG>
<P>次の例は、永続名 が <B>oct.guest.dump</B> 容量が 2 MB の磁気テープの出力例です。容量は KB 単位で出力されています (2097152 = 2 x 1024<SUP>2</SUP>)。
<PRE>   % <B>backup readlabel -portoffset 6</B>
   Tape read was labelled: oct.guest.dump (907215000)
        size: 2097152 Kbytes
   
</PRE>
<P>[テープ・コーディネーター] ウィンドウの出力は、次のようになります。
<PRE>   Tape label
   ----------
   tape name = oct.guest.dump
   AFS tape name = guests.monthly.3
   creationTime = Thu Oct 1 00:10:00 1998
   cell = abc.com
   size = 2097152 Kbytes
   dump path = /monthly
   dump id = 907215000
   useCount = 5
   ---- End of tape label ----
   
</PRE>
<P>永続名のない磁気テープの場合は、次のようになります。
<PRE>   % backup readlabel -portoffset 6
   Tape read was labelled: guests.monthly.2 (909899900)
        size: 2097152 Kbytes
   
</PRE>
<P>[テープ・コーディネーター] ウィンドウの出力は、次のようになります。
<PRE>   Tape label
   ----------
   tape name = &lt;NULL>
   AFS tape name = guests.monthly.2
   creationTime = Sun Nov 1 00:58:20 1998
   cell = abc.com
   size = 2097152 Kbytes
   dump path = /monthly
   dump id = 909899900
   useCount = 1
   ---- End of tape label ----
   
</PRE>
<P><STRONG>必要となる特権</STRONG>
<P>コマンドの発行者は、バックアップ・サーバーが実行されているすべてのマシン上の <B>/usr/afs/etc/UserList</B> ファイルにリストされていなければなりません。また、<B>-localauth</B> フラグを使用する場合は、ローカル・スーパーユーザー <B>root</B> としてサーバー・マシンにログオンする必要があります。
<P><STRONG>関連情報 </STRONG>
<P><A HREF="auarf060.htm#HDRBK_INTRO">backup</A>
<P><A HREF="auarf079.htm#HDRBK_LABELTAPE">backup labeltape</A>
<P><A HREF="auarf126.htm#HDRBUTC">butc</A>
<P>
<P><HR><B>&#91; <A HREF="#Top_Of_Page">ページのトップ</A> &#124; <A HREF="auarf083.htm">前ページ</A> &#124; <A HREF="auarf085.htm">次ページ</A> &#124; <A HREF="auarf002.htm#ToC">目次</A> &#124; <A HREF="auarf284.htm#HDRINDEX">索引</A> &#93;</B> 
<!-- Begin Footer Records  ========================================== -->
<P><HR><B> 
<br>(C) <A HREF="http://www.ibm.com/">IBM Corporation 2000.</A>  All Rights Reserved 
</B> 
<!-- End Footer Records  ============================================ -->
<A NAME="Bot_Of_Page"></A>
</BODY></HTML>
