<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3//EN">
<HTML><HEAD>
<TITLE>管理解説書</TITLE>
<!-- Begin Header Records  ========================================== -->
<!-- C:\IDWB\TEMP\idwt1068\AUARF000.SCR converted by idb2h R4.2 (359) -->
<!-- ID Workbench Version (OS2) on 24 Dec 1999 at 21:46:04            -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Shift_JIS">
<META HTTP-EQUIV="updated" CONTENT="Fri, 24 Dec 1999 21:46:02">
<META HTTP-EQUIV="review" CONTENT="Sun, 24 Dec 2000 21:46:02">
<META HTTP-EQUIV="expires" CONTENT="Mon, 24 Dec 2001 21:46:02">
</HEAD><BODY>
<!-- (C) IBM Corporation 2000. All Rights Reserved    --> 
<BODY bgcolor="ffffff"> 
<!-- End Header Records  ============================================ -->
<A NAME="Top_Of_Page"></A>
<H1>管理解説書</H1>
<P>
<H2><A NAME="HDRBUTC" HREF="auarf002.htm#ToC_140">butc</A></H2>
<A NAME="IDX4691"></A>
<A NAME="IDX4692"></A>
<A NAME="IDX4693"></A>
<A NAME="IDX4694"></A>
<A NAME="IDX4695"></A>
<A NAME="IDX4696"></A>
<P><STRONG>目的</STRONG>
<P>磁気テープ・コーディネーター・プロセスを初期化します。
<P><STRONG>構文</STRONG>
<PRE><B>butc</B> [<B>-port</B> &lt;<VAR>port offset</VAR>>]  [<B>-debuglevel</B> &lt; <B>0</B> | <B>1</B> | <B>2</B> >]  
     [<B>-cell</B> &lt;<VAR>cell name</VAR>>]  [<B>-noautoquery</B>]  
     [<B>-localauth</B>]  [<B>-help</B>]
        
<B>butc</B> [<B>-p</B> &lt;<VAR>port offset</VAR>>]  [<B>-d</B> &lt; <B>0</B> | <B>1</B> | <B>2</B> >]  
     [<B>-c</B> &lt;<VAR>cell name</VAR>>]  [<B>-n</B>]  [<B>-l</B>]  [<B>-h</B>]
</PRE>
<P><STRONG>構文</STRONG>
<P><B>butc</B> コマンドは、磁気テープ・コーディネーター・マシン上で磁気テープ・コーディネーター・プロセスを初期化します。これにより、操作員は、バックアップ・システムの要求を、関連付けられた磁気テープ装置またはバックアップ・データ・ファイルに送信することができます。
(磁気テープ・コーディネーターは、<B>FILE YES</B> 命令が <B>/usr/afs/backup/tapeconfig</B> ファイルの磁気テープ・コーディネーターの項目に対応する <B>/usr/afs/backup/CFG_</B><VAR>device_name</VAR> ファイルにある場合に、バックアップ・データを制御します。説明を簡単にするために、以下では磁気テープ装置について説明します。)
<P>従来は、フォアグラウンドでテープ・コーディネーターを開始し、実行していました。このような場合、独自の接続で実行されます。この接続は、ほかには使用できず、テープ・コーディネーターがバックアップ要求を受け入れている間およびその要求を実行している間は、いつでもオープンしたままにしておかなければなりません。
(ウィンドウ・マネージャーを使用している場合には、この接続は別のコマンド・シェル・ウィンドウに対応します。)
テープ・コーディネーターがオペレーターにプロンプトを出す必要がないように、
<B>CFG_</B><VAR>device_name</VAR> ファイルが構成されている場合は、テープ・コーディネーターはバックグラウンドで実行することができます。フォアグラウンドおよびバックグラウンドのどちらでも、テープ・コーディネーターは、開始に使用された接続の標準出力ストリームに、オペレーション・トレースおよびほかの出力を書き込みます。表示される情報量を制御する場合には、<B>-debuglevel</B>
引き数を使用してください。また、磁気テープ・コーディネーターは、ローカルの <B>/usr/afs/backup</B> ディレクトリーの以下の 2 つのファイルに追跡メッセージとエラー・メッセージを書き込みます。
<UL>
<LI><B>TE_</B><VAR>device_name</VAR> ファイルは、磁気テープ・コーディネーターがバックアップ・オペレーティングを実行中に検出した問題を記録します。
</LI><LI>The <B>TL_</B><VAR>device_name</VAR> ファイルは、<B>TE_</B><VAR>device_name</VAR> ファイルに書き込まれたのと同じエラーと操作の追跡を記録します。
</LI></UL>
<P>磁気テープ・コーディネーターは、初期設定時に自動的にこれらのファイルを作成します。既存ファイルがある場合は、磁気テープ・コーディネーターはそれらのファイルの拡張子を <B>.old</B> で置き換え、既存の <B>.old</B> ファイルが存在する場合はそれを上書きします。ファイル名の <VAR>device_name</VAR> の部分は、装置名の <B>/dev/</B> 接頭部を削除して、残りのスラッシュを下線に置換して生成します。たとえば、<B>/dev/rmt/4m</B> という装置のファイル名は、<B>TE_rmt_4m</B> および <B>TL_rmt_4m</B> になります。
<P>デフォルトでは、各オペレーションの開始時に、テープ・コーディネーターは、最初のテープをドライブに挿入して、
&lt;<B>Return</B>> を押すよう、オペレーターにプロンプトを出します。このプロンプトを抑制するには、コマンド行に <B>-noautoquery</B> フラグを組み込むか、
<B>/usr/afs/backup/CFG_</B><VAR>device_name</VAR> ファイルに命令
<B>AUTOQUERY NO</B> を組み込みます。プロンプトを抑制する場合には、
<B>backup</B> コマンドを発行する前に、最初に要求されるテープをドライブに挿入しておかなければなりません。以降のテープについては、テープ・コーディネーターは、通常のテープ獲得ルーチンを使用します。
<B>/usr/afs/backup/CFG_</B><VAR>device_name</VAR> ファイルに
<B>MOUNT</B> 命令を組み込む場合には、テープ・コーディネーターは指示されたコマンドを呼び出します。そうでない場合には、次のテープを求めるプロンプトがオペレーターに出されます。
<P>テープ・コーディネーター・プロセスを停止するには、専用接続を介して (コマンド・シェル・ウィンドウで)
&lt;<B>Ctrl-c</B>> などの割り込みシグナルを入力します。
<P>テープを呼び出す <B>backup</B> オペレーションを開始する前に、このオペレーションを取り消すには
(最初のテープ・プロンプトが抑制されなかったことを想定している)、最初のテープを求めるテープ・コーディネーターのプロンプトで、文字 <B>a</B> (<B>abort</B> の) を入力し、
&lt;<B>Return</B>> を押します。
<P>テープ・コーディネーター・オペレーションは、以下のリストで説明するように、一定のファイルの正しい構成によって異なります。
<UL>
<LI>ローカルの <B>/usr/afs/backup/tapeconfig</B> ファイルには、情報の中でも特に、装置名やポート・オフセット番号を指定した磁気テープ・コーディネーターの項目が含まれていなければなりません。詳細については、<B>tapeconfig</B> の解説ページを参照してください。
</LI><LI>バックアップ・データベースのテープ・コーディネーターの項目に記録されるポート・オフセット番号は、
<B>tapeconfig</B> ファイルにある番号と同じでなければなりません。
<B>backup addhost</B> コマンドを使用して、バックアップ・データベース項目を作成してください。
</LI><LI>オプションの <B>/usr/afs/backup/CFG_</B><VAR>device_name</VAR> ファイルには、磁気テープのマウントとアンマウントを自動で行ったり (たとえば、テープ・スタッカーまたはジュークボックスを使用する場合)、またはバックアップ・プロセスの他の過程を自動化するための命令を組み込むことができます。名前の <VAR>device_name</VAR> 部分は、以前に説明したように、
<B>TE_</B><VAR>device_name</VAR> ファイルおよび
<B>TL_</B><VAR>device_name</VAR> ファイル用に派生されます。
</LI></UL>
<P><STRONG>注意</STRONG>
<P>磁気テープ・コーディネーター・マシンが AIX マシンの場合、
<B>SMIT</B> ユーティリティーを使用して、装置のブロック・サイズを 0 (ゼロ)に設定してください。これは、可変ブロック・サイズを意味します。そうでない場合、他のオペレーティング・システムが稼動しているマシンに接続している磁気テープ装置では、AIX マシン上で書き込まれた磁気テープが読み込めない場合があります。詳しい説明は、バックアップ・システムの構成に関する <I>AFS 管理の手引き</I> の章を参照してください。
<P><STRONG>オプション </STRONG>
<DL>
<P><DT><B>-port
</B><DD>初期化する磁気テープ・コーディネーターのポート・オフセット番号を指定します。
<P><DT><B>-debuglevel
</B><DD>磁気テープ・コーディネーターが標準出力ストリームに表示するメッセージの量とタイプを制御します。3 つの許容値のうち 1 つを指定してください。
<UL>
<LI><B>0</B> を指定すると、磁気テープ・コーディネーターの操作の説明に最低限必要な詳細が表示されます。たとえば、磁気テープをドライブに挿入するためのプロンプト、操作の開始および終了を示すメッセージ、それにエラー・メッセージなどです。これはデフォルト値です。
</LI><LI><B>1</B> を指定すると、ダンプあるいは復元されるボリューム名とレベル 0 で表示される情報が表示されます。
</LI><LI><B>2</B> を指定すると、<B>TL_</B><VAR>device_name</VAR> ログ・ファイルに書き込まれているすべてのメッセージが表示されます。
</LI></UL>
<P><DT><B>-cell
</B><DD>磁気テープ・コーディネーターが操作するセル名 (影響するボリュームのあるファイル・サーバー・マシンが所属するセル) を指定します。この引き数を省略すると、コマンドは、ローカルの <B>/usr/vice/etc/ThisCell</B> ファイルの定義通りに、ローカル・セルで実行されます。このフラグは、<B>-localauth</B> 引き数と一緒に使用しないでください。
<P><DT><B>-noautoquery
</B><DD>この引き数を使用すると、操作に必要な最初の磁気テープを要求する磁気テープ・コーディネーター・プロンプトが表示されません。操作員は、操作を初期化する <B>backup</B> コマンドを発行する前に、磁気テープをドライブに挿入しなければなりません。
<P><DT><B>-localauth
</B><DD>ローカルの <B>/usr/afs/etc/KeyFile</B> ファイルにある最高のキー・バージョン番号をもつサーバー暗号化鍵を使用して、サーバー・チケットを構成します。
<B>butc</B> コマンド・インタープリターは、相互認証で使用するためのボリューム・サーバーおよびボリューム・ロケーション・サーバーに、無期限のチケットを提供します。
<P>
<P>この引き数を <B>-cell</B> フラグと組み合わせて使用しないでください。この引き数を使用するのは、ローカルのスーパーユーザー <B>root</B> としてサーバー・マシンにログオンした場合だけにしてください。クライアント・マシンには <B>/usr/afs/etc/KeyFile</B> ファイルはありません。
<P><DT><B>-help
</B><DD>このコマンドのオンライン・ヘルプを出力します。これ以外の有効なオプションはすべて無視されます。
</DL>
<P><STRONG>例</STRONG>
<P>次のコマンドは、ポート・オフセット <B>7</B> の 磁気テープ・コーディネーターをデバッグ・レベル <B>1</B> で開始します。これは、磁気テープ・コーディネーターがダンプまたは復元しているボリューム名が表示されます。
<PRE>   % <B>butc -port 7 -debuglevel 1</B>
   
</PRE>
<P><STRONG>必要となる特権</STRONG>
<P>コマンドの発行者は、バックアップ・サーバーまたはボリューム・ロケーション (VL) サーバーが稼動しているすべてのマシンおよびバックアップされるボリュームのあるファイル・サーバー・マシン上の
<B>/usr/afs/etc/UserList</B> ファイルにリストされていなければなりません。
<B>-localauth</B> フラグがある場合、コマンドの発行者は、ローカル・スーパーユーザー <B>root</B> として磁気テープ・コーディネーター・マシンにログオンしている必要があります。また、コマンドの発行者はローカル <B>/usr/afs/backup</B> ディレクトリーのログ・ファイルおよび構成ファイルに対して、読み込みおよび書き込みが可能でなければなりません。
<P><STRONG>関連情報 </STRONG>
<P><A HREF="auarf018.htm#HDRCFG">CFG_<I>device_name</I></A>
<P><A HREF="auarf023.htm#HDRKEYFILE">KeyFile</A>
<P><A HREF="auarf031.htm#HDRTE">TE_<I>device_name</I></A>
<P><A HREF="auarf032.htm#HDRCLI_THISCELL">ThisCell (クライアント・バージョン)</A>
<P><A HREF="auarf034.htm#HDRTL">TL_<I>device_name</I></A>
<P><A HREF="auarf035.htm#HDRUSERLIST">UserList</A>
<P><A HREF="auarf050.htm#HDRTAPECONFIG">tapeconfig</A>
<P><A HREF="auarf062.htm#HDRBK_ADDHOST">backup addhost</A>
<P>
<P><HR><B>&#91; <A HREF="#Top_Of_Page">ページのトップ</A> &#124; <A HREF="auarf125.htm">前ページ</A> &#124; <A HREF="auarf127.htm">次ページ</A> &#124; <A HREF="auarf002.htm#ToC">目次</A> &#124; <A HREF="auarf284.htm#HDRINDEX">索引</A> &#93;</B> 
<!-- Begin Footer Records  ========================================== -->
<P><HR><B> 
<br>(C) <A HREF="http://www.ibm.com/">IBM Corporation 2000.</A>  All Rights Reserved 
</B> 
<!-- End Footer Records  ============================================ -->
<A NAME="Bot_Of_Page"></A>
</BODY></HTML>
